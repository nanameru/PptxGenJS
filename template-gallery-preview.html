<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PptxGenJS ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚®ãƒ£ãƒ©ãƒªãƒ¼ with ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #f8f9fa;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
        }
        .hero-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 3rem 0;
            margin-bottom: 3rem;
        }
        .template-card {
            border: none;
            border-radius: 10px;
            overflow: hidden;
            transition: transform 0.3s, box-shadow 0.3s;
            height: 100%;
        }
        .template-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }
        .template-category {
            background-color: white;
            border-radius: 10px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }
        .category-title {
            color: #333;
            margin-bottom: 1.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid #667eea;
        }
        .btn-demo {
            background-color: #667eea;
            color: white;
            border: none;
            transition: background-color 0.3s;
            margin-right: 0.5rem;
        }
        .btn-demo:hover {
            background-color: #764ba2;
            color: white;
        }
        .btn-preview {
            background-color: #28a745;
            color: white;
            border: none;
            transition: background-color 0.3s;
        }
        .btn-preview:hover {
            background-color: #218838;
            color: white;
        }
        .template-image {
            height: 200px;
            object-fit: cover;
            background-color: #e9ecef;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            color: #6c757d;
        }
        .code-preview {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 1rem;
            margin-top: 1rem;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            max-height: 200px;
            overflow-y: auto;
        }
        
        /* ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ¢ãƒ¼ãƒ€ãƒ«ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .slide-preview-container {
            background-color: #2c2c2c;
            border-radius: 10px;
            padding: 20px;
            min-height: 400px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .slide-preview {
            background-color: white;
            width: 100%;
            max-width: 800px;
            aspect-ratio: 16/9;
            border-radius: 5px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            overflow: hidden;
            position: relative;
        }
        
        .slide-content {
            padding: 40px;
            height: 100%;
            display: flex;
            flex-direction: column;
        }
        
        .slide-navigation {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-top: 1rem;
        }
        
        .modal-xl {
            max-width: 90%;
        }
        
        /* ãƒãƒ£ãƒ¼ãƒˆãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .chart-container {
            width: 100%;
            height: 300px;
            margin: 20px 0;
        }
        
        /* ãƒ†ãƒ¼ãƒ–ãƒ«ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .preview-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        
        .preview-table th,
        .preview-table td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        
        .preview-table th {
            background-color: #363636;
            color: white;
            font-weight: bold;
        }
        
        /* ã‚·ã‚§ã‚¤ãƒ—ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .shape-container {
            display: flex;
            justify-content: space-around;
            align-items: center;
            height: 200px;
            margin: 20px 0;
        }
        
        .shape {
            transition: transform 0.3s;
        }
        
        .shape:hover {
            transform: scale(1.1);
        }
    </style>
</head>
<body>
    <div class="hero-section">
        <div class="container">
            <h1 class="display-4 fw-bold mb-3">PptxGenJS ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚®ãƒ£ãƒ©ãƒªãƒ¼</h1>
            <p class="lead">ã‚¹ãƒ©ã‚¤ãƒ‰ã‚’Webã§ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã—ã¦ã‹ã‚‰ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</p>
        </div>
    </div>

    <div class="container">
        <!-- ãƒãƒ£ãƒ¼ãƒˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ -->
        <div class="template-category">
            <h2 class="category-title">ğŸ“Š ãƒãƒ£ãƒ¼ãƒˆ</h2>
            <div class="row g-4">
                <div class="col-md-4">
                    <div class="card template-card">
                        <div class="template-image">
                            ğŸ“Š
                        </div>
                        <div class="card-body">
                            <h5 class="card-title">æ£’ã‚°ãƒ©ãƒ•</h5>
                            <p class="card-text">å£²ä¸Šãƒ‡ãƒ¼ã‚¿ã‚„æ¯”è¼ƒåˆ†æã«æœ€é©ãªæ£’ã‚°ãƒ©ãƒ•ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ</p>
                            <button class="btn btn-preview" onclick="previewChart('bar')">ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</button>
                            <button class="btn btn-demo" onclick="generateChart('bar')">ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</button>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card template-card">
                        <div class="template-image">
                            ğŸ“ˆ
                        </div>
                        <div class="card-body">
                            <h5 class="card-title">æŠ˜ã‚Œç·šã‚°ãƒ©ãƒ•</h5>
                            <p class="card-text">æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿ã‚„ãƒˆãƒ¬ãƒ³ãƒ‰åˆ†æç”¨ã®æŠ˜ã‚Œç·šã‚°ãƒ©ãƒ•</p>
                            <button class="btn btn-preview" onclick="previewChart('line')">ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</button>
                            <button class="btn btn-demo" onclick="generateChart('line')">ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</button>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card template-card">
                        <div class="template-image">
                            ğŸ¥§
                        </div>
                        <div class="card-body">
                            <h5 class="card-title">å††ã‚°ãƒ©ãƒ•</h5>
                            <p class="card-text">å‰²åˆã‚„æ§‹æˆã‚’è¦–è¦šåŒ–ã™ã‚‹å††ã‚°ãƒ©ãƒ•</p>
                            <button class="btn btn-preview" onclick="previewChart('pie')">ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</button>
                            <button class="btn btn-demo" onclick="generateChart('pie')">ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ãƒ†ãƒ¼ãƒ–ãƒ«ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ -->
        <div class="template-category">
            <h2 class="category-title">ğŸ“‹ ãƒ†ãƒ¼ãƒ–ãƒ«</h2>
            <div class="row g-4">
                <div class="col-md-4">
                    <div class="card template-card">
                        <div class="template-image">
                            ğŸ“‹
                        </div>
                        <div class="card-body">
                            <h5 class="card-title">åŸºæœ¬ãƒ†ãƒ¼ãƒ–ãƒ«</h5>
                            <p class="card-text">ã‚·ãƒ³ãƒ—ãƒ«ã§è¦‹ã‚„ã™ã„åŸºæœ¬çš„ãªãƒ†ãƒ¼ãƒ–ãƒ«ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ</p>
                            <button class="btn btn-preview" onclick="previewTable('basic')">ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</button>
                            <button class="btn btn-demo" onclick="generateTable('basic')">ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</button>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card template-card">
                        <div class="template-image">
                            ğŸ“Š
                        </div>
                        <div class="card-body">
                            <h5 class="card-title">ã‚¹ã‚¿ã‚¤ãƒ«ä»˜ããƒ†ãƒ¼ãƒ–ãƒ«</h5>
                            <p class="card-text">è‰²åˆ†ã‘ã‚„ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆãŒé©ç”¨ã•ã‚ŒãŸãƒ†ãƒ¼ãƒ–ãƒ«</p>
                            <button class="btn btn-preview" onclick="previewTable('styled')">ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</button>
                            <button class="btn btn-demo" onclick="generateTable('styled')">ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</button>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card template-card">
                        <div class="template-image">
                            ğŸ“ˆ
                        </div>
                        <div class="card-body">
                            <h5 class="card-title">ãƒ‡ãƒ¼ã‚¿ãƒ†ãƒ¼ãƒ–ãƒ«</h5>
                            <p class="card-text">å¤§é‡ã®ãƒ‡ãƒ¼ã‚¿ã‚’æ•´ç†ã—ã¦è¡¨ç¤ºã™ã‚‹ãƒ†ãƒ¼ãƒ–ãƒ«</p>
                            <button class="btn btn-preview" onclick="previewTable('data')">ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</button>
                            <button class="btn btn-demo" onclick="generateTable('data')">ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</button>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card template-card">
                        <div class="template-image">
                            ğŸ“
                        </div>
                        <div class="card-body">
                            <h5 class="card-title">è©•ä¾¡ã¨èª²é¡Œ</h5>
                            <p class="card-text">é …ç›®ã”ã¨ã®è©•ä¾¡ã¨èª²é¡Œã‚’ã¾ã¨ã‚ãŸãƒ¬ãƒãƒ¼ãƒˆç”¨ãƒ†ãƒ¼ãƒ–ãƒ«</p>
                            <button class="btn btn-preview" onclick="previewTable('evaluation')">ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</button>
                            <button class="btn btn-demo" onclick="generateTable('evaluation')">ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ã‚·ã‚§ã‚¤ãƒ—ãƒ»å›³å½¢ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ -->
        <div class="template-category">
            <h2 class="category-title">ğŸ”· ã‚·ã‚§ã‚¤ãƒ—ãƒ»å›³å½¢</h2>
            <div class="row g-4">
                <div class="col-md-4">
                    <div class="card template-card">
                        <div class="template-image">
                            ğŸ”·
                        </div>
                        <div class="card-body">
                            <h5 class="card-title">åŸºæœ¬å›³å½¢</h5>
                            <p class="card-text">å††ã€å››è§’ã€ä¸‰è§’ãªã©ã®åŸºæœ¬çš„ãªå›³å½¢</p>
                            <button class="btn btn-preview" onclick="previewShape('basic')">ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</button>
                            <button class="btn btn-demo" onclick="generateShape('basic')">ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</button>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card template-card">
                        <div class="template-image">
                            ğŸ“
                        </div>
                        <div class="card-body">
                            <h5 class="card-title">ãƒ•ãƒ­ãƒ¼ãƒãƒ£ãƒ¼ãƒˆ</h5>
                            <p class="card-text">ãƒ—ãƒ­ã‚»ã‚¹ã‚„æ‰‹é †ã‚’ç¤ºã™ãƒ•ãƒ­ãƒ¼ãƒãƒ£ãƒ¼ãƒˆå›³å½¢</p>
                            <button class="btn btn-preview" onclick="previewShape('flowchart')">ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</button>
                            <button class="btn btn-demo" onclick="generateShape('flowchart')">ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</button>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card template-card">
                        <div class="template-image">
                            ğŸ¨
                        </div>
                        <div class="card-body">
                            <h5 class="card-title">ã‚«ã‚¹ã‚¿ãƒ å›³å½¢</h5>
                            <p class="card-text">ç‹¬è‡ªã®ãƒ‡ã‚¶ã‚¤ãƒ³ã‚„ãƒ‘ã‚¿ãƒ¼ãƒ³ã®å›³å½¢</p>
                            <button class="btn btn-preview" onclick="previewShape('custom')">ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</button>
                            <button class="btn btn-demo" onclick="generateShape('custom')">ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ãƒ†ã‚­ã‚¹ãƒˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ -->
        <div class="template-category">
            <h2 class="category-title">ğŸ“ ãƒ†ã‚­ã‚¹ãƒˆ</h2>
            <div class="row g-4">
                <div class="col-md-4">
                    <div class="card template-card">
                        <div class="template-image">
                            ğŸ“
                        </div>
                        <div class="card-body">
                            <h5 class="card-title">ã‚¿ã‚¤ãƒˆãƒ«ã‚¹ãƒ©ã‚¤ãƒ‰</h5>
                            <p class="card-text">ã‚¤ãƒ³ãƒ‘ã‚¯ãƒˆã®ã‚ã‚‹ã‚¿ã‚¤ãƒˆãƒ«ã‚¹ãƒ©ã‚¤ãƒ‰ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ</p>
                            <button class="btn btn-preview" onclick="previewText('title')">ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</button>
                            <button class="btn btn-demo" onclick="generateText('title')">ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</button>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card template-card">
                        <div class="template-image">
                            ğŸ“„
                        </div>
                        <div class="card-body">
                            <h5 class="card-title">ç®‡æ¡æ›¸ããƒªã‚¹ãƒˆ</h5>
                            <p class="card-text">æƒ…å ±ã‚’æ•´ç†ã—ã¦è¡¨ç¤ºã™ã‚‹ç®‡æ¡æ›¸ããƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ</p>
                            <button class="btn btn-preview" onclick="previewText('bullets')">ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</button>
                            <button class="btn btn-demo" onclick="generateText('bullets')">ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</button>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card template-card">
                        <div class="template-image">
                            ğŸ’¬
                        </div>
                        <div class="card-body">
                            <h5 class="card-title">å¼•ç”¨æ–‡</h5>
                            <p class="card-text">å°è±¡çš„ãªå¼•ç”¨æ–‡ã‚’è¡¨ç¤ºã™ã‚‹ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ</p>
                            <button class="btn btn-preview" onclick="previewText('quote')">ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</button>
                            <button class="btn btn-demo" onclick="generateText('quote')">ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- AIãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ -->
        <div class="template-category">
            <h2 class="category-title">ğŸ¤– AIãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³</h2>
            <div class="row g-4">
                <div class="col-md-6">
                    <div class="card template-card">
                        <div class="template-image">
                            ğŸ¤–
                        </div>
                        <div class="card-body">
                            <h5 class="card-title">AIãŒæ‹“ãæœªæ¥</h5>
                            <p class="card-text">AIã‚’ãƒ†ãƒ¼ãƒã«ã—ãŸåŒ…æ‹¬çš„ãªãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆ5ã‚¹ãƒ©ã‚¤ãƒ‰æ§‹æˆï¼‰</p>
                            <button class="btn btn-preview" onclick="previewAI('future')">ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</button>
                            <button class="btn btn-demo" onclick="generateAI('future')">ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</button>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="card template-card">
                        <div class="template-image">
                            ğŸŒŸ
                        </div>
                        <div class="card-body">
                            <h5 class="card-title">æŠ€è¡“é©æ–°ã¨ç¤¾ä¼šå¤‰é©</h5>
                            <p class="card-text">AIæŠ€è¡“ã®ç¾åœ¨ã¨æœªæ¥ã‚’åˆ†æã™ã‚‹ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ</p>
                            <button class="btn btn-preview" onclick="previewAI('innovation')">ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</button>
                            <button class="btn btn-demo" onclick="generateAI('innovation')">ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- JSONãƒ™ãƒ¼ã‚¹PPTXç”Ÿæˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ -->
        <div class="template-category">
            <h2 class="category-title">ğŸ“„ JSONãƒ™ãƒ¼ã‚¹PPTXç”Ÿæˆ</h2>
            <div class="row g-4">
                <div class="col-md-12">
                    <div class="card template-card">
                        <div class="card-body">
                            <h5 class="card-title">JSONã‹ã‚‰PPTXç”Ÿæˆ</h5>
                            <p class="card-text">æ§‹é€ åŒ–ã•ã‚ŒãŸJSONãƒ‡ãƒ¼ã‚¿ã‹ã‚‰é«˜æ©Ÿèƒ½ãªPPTXãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”Ÿæˆã—ã¾ã™</p>
                            
                            <!-- JSONå…¥åŠ›ã‚¨ãƒªã‚¢ -->
                            <div class="mb-3">
                                <label for="jsonInput" class="form-label">JSONãƒ‡ãƒ¼ã‚¿å…¥åŠ›:</label>
                                <textarea class="form-control" id="jsonInput" rows="15" placeholder="JSONãƒ‡ãƒ¼ã‚¿ã‚’ã“ã“ã«è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„...">
{
  "title": "AIæŠ€è¡“ã®æœ€æ–°å‹•å‘",
  "author": "AI Research Team",
  "company": "Tech Innovation Lab",
  "layout": "LAYOUT_16x9",
  "slides": [
    {
      "slideIndex": 0,
      "topic": "AIæŠ€è¡“ã®é©å‘½",
      "background": {
        "type": "gradient",
        "colors": ["667eea", "764ba2"],
        "angle": 135
      },
      "elements": [
        {
          "type": "text",
          "textType": "title",
          "content": "AIæŠ€è¡“ã®é©å‘½",
          "options": {
            "x": 5,
            "y": 35,
            "w": 90,
            "h": 15
          },
          "style": {
            "fontSize": 48,
            "bold": true,
            "color": "FFFFFF",
            "align": "center"
          }
        },
        {
          "type": "text",
          "textType": "subtitle", 
          "content": "æ¬¡ä¸–ä»£ãƒ†ã‚¯ãƒãƒ­ã‚¸ãƒ¼ã®å¯èƒ½æ€§",
          "options": {
            "x": 5,
            "y": 52,
            "w": 90,
            "h": 10
          },
          "style": {
            "fontSize": 24,
            "color": "E0E0E0",
            "align": "center"
          }
        }
      ]
    },
    {
      "slideIndex": 1,
      "topic": "AIæ´»ç”¨äº‹ä¾‹",
      "background": "#F8F9FA",
      "elements": [
        {
          "type": "text",
          "textType": "title",
          "content": "AIæ´»ç”¨äº‹ä¾‹",
          "options": {
            "x": 8,
            "y": 15,
            "w": 84,
            "h": 18
          },
          "style": {
            "fontSize": 48,
            "bold": true,
            "color": "0D47A1"
          }
        },
        {
          "type": "chart",
          "chartType": "bar",
          "data": [
            {
              "name": "åŠ¹æœæ¸¬å®š",
              "labels": ["åŒ»ç™‚", "é‡‘è", "è£½é€ ", "å°å£²"],
              "values": [85, 72, 68, 58]
            }
          ],
          "options": {
            "x": 10,
            "y": 40,
            "w": 80,
            "h": 50
          },
          "chartOptions": {
            "title": "æ¥­ç•Œåˆ¥AIå°å…¥åŠ¹æœï¼ˆ%ï¼‰",
            "showValue": true,
            "chartColors": ["4285F4", "34A853", "FBBC04", "EA4335"]
          }
        }
      ]
    },
    {
      "slideIndex": 2,
      "topic": "æŠ€è¡“æ¯”è¼ƒè¡¨",
      "background": "#FFFFFF",
      "elements": [
        {
          "type": "text",
          "textType": "title",
          "content": "AIæŠ€è¡“æ¯”è¼ƒ",
          "options": {
            "x": 5,
            "y": 10,
            "w": 90,
            "h": 15
          },
          "style": {
            "fontSize": 36,
            "bold": true,
            "color": "1F2937",
            "align": "center"
          }
        },
        {
          "type": "table",
          "data": [
            [
              {"text": "æŠ€è¡“", "options": {"fill": "4285F4", "color": "FFFFFF", "bold": true}},
              {"text": "ç²¾åº¦", "options": {"fill": "4285F4", "color": "FFFFFF", "bold": true}},
              {"text": "å‡¦ç†é€Ÿåº¦", "options": {"fill": "4285F4", "color": "FFFFFF", "bold": true}},
              {"text": "ã‚³ã‚¹ãƒˆ", "options": {"fill": "4285F4", "color": "FFFFFF", "bold": true}}
            ],
            ["æ©Ÿæ¢°å­¦ç¿’", "85%", "é«˜é€Ÿ", "ä¸­"],
            ["æ·±å±¤å­¦ç¿’", "92%", "ä¸­é€Ÿ", "é«˜"],
            ["å¼·åŒ–å­¦ç¿’", "88%", "ä½é€Ÿ", "é«˜"]
          ],
          "options": {
            "x": 10,
            "y": 30,
            "w": 80,
            "h": 60
          },
          "tableOptions": {
            "border": {"type": "solid", "pt": 1, "color": "CCCCCC"},
            "fontSize": 16,
            "align": "center"
          }
        }
      ]
    }
  ]
}</textarea>
                            </div>
                            
                            <div class="d-flex gap-2 mb-3">
                                <button class="btn btn-preview" onclick="previewFromJSON()">ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</button>
                                <button class="btn btn-demo" onclick="generateFromJSON()">ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</button>
                                <button class="btn btn-secondary" onclick="loadSampleJSON()">ã‚µãƒ³ãƒ—ãƒ«èª­ã¿è¾¼ã¿</button>
                                <button class="btn btn-warning" onclick="validateJSON()">JSONæ¤œè¨¼</button>
                            </div>
                            
                            <div id="jsonValidationResult" class="alert" style="display: none;"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- é«˜åº¦ãªæ©Ÿèƒ½ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ -->
        <div class="template-category">
            <h2 class="category-title">âš¡ é«˜åº¦ãªæ©Ÿèƒ½</h2>
            <div class="row g-4">
                <div class="col-md-4">
                    <div class="card template-card">
                        <div class="template-image">
                            ğŸ¨
                        </div>
                        <div class="card-body">
                            <h5 class="card-title">é«˜åº¦ãªå›³å½¢æ©Ÿèƒ½</h5>
                            <p class="card-text">ã‚«ã‚¹ã‚¿ãƒ ã‚¸ã‚ªãƒ¡ãƒˆãƒªã€å½±åŠ¹æœã€ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã€å›è»¢ã‚’å«ã‚€å›³å½¢</p>
                            <button class="btn btn-preview" onclick="previewAdvanced('shapes')">ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</button>
                            <button class="btn btn-demo" onclick="generateAdvanced('shapes')">ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</button>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card template-card">
                        <div class="template-image">
                            ğŸ–¼ï¸
                        </div>
                        <div class="card-body">
                            <h5 class="card-title">ç”»åƒå‡¦ç†æ©Ÿèƒ½</h5>
                            <p class="card-text">ãƒªã‚µã‚¤ã‚ºã€ã‚¯ãƒ­ãƒƒãƒ”ãƒ³ã‚°ã€é€æ˜åº¦ã€å›è»¢ã€SVGã‚µãƒãƒ¼ãƒˆ</p>
                            <button class="btn btn-preview" onclick="previewAdvanced('images')">ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</button>
                            <button class="btn btn-demo" onclick="generateAdvanced('images')">ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</button>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card template-card">
                        <div class="template-image">
                            ğŸ“Š
                        </div>
                        <div class="card-body">
                            <h5 class="card-title">é«˜åº¦ãªãƒãƒ£ãƒ¼ãƒˆ</h5>
                            <p class="card-text">3Dãƒãƒ£ãƒ¼ãƒˆã€ãƒãƒ«ãƒã‚·ãƒªãƒ¼ã‚ºã€ã‚«ã‚¹ã‚¿ãƒ ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°</p>
                            <button class="btn btn-preview" onclick="previewAdvanced('charts')">ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</button>
                            <button class="btn btn-demo" onclick="generateAdvanced('charts')">ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ã‚³ãƒ¼ãƒ‰è¡¨ç¤ºã‚¨ãƒªã‚¢ -->
        <div class="template-category">
            <h2 class="category-title">ğŸ’» ã‚³ãƒ¼ãƒ‰ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</h2>
            <div id="codePreview" class="code-preview">
                <p class="text-muted">ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ã‚³ãƒ¼ãƒ‰ä¾‹ã‚’è¡¨ç¤º</p>
            </div>
        </div>
    </div>

    <!-- ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ¢ãƒ¼ãƒ€ãƒ« -->
    <div class="modal fade" id="previewModal" tabindex="-1" aria-labelledby="previewModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="previewModalLabel">ã‚¹ãƒ©ã‚¤ãƒ‰ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="slide-preview-container">
                        <div class="slide-preview">
                            <div id="slideContent" class="slide-content">
                                <!-- ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™ -->
                            </div>
                        </div>
                    </div>
                    <div class="slide-navigation">
                        <button class="btn btn-secondary" onclick="previousSlide()" id="prevBtn">å‰ã¸</button>
                        <span id="slideIndicator">1 / 1</span>
                        <button class="btn btn-secondary" onclick="nextSlide()" id="nextBtn">æ¬¡ã¸</button>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">é–‰ã˜ã‚‹</button>
                    <button type="button" class="btn btn-primary" id="downloadBtn">ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Chart.js for chart previews -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- PptxGenJS ãƒ©ã‚¤ãƒ–ãƒ©ãƒª -->
    <script src="https://cdn.jsdelivr.net/gh/gitbrent/pptxgenjs@latest/dist/pptxgen.bundle.js"></script>
    
    <script>
        let currentSlides = [];
        let currentSlideIndex = 0;
        let currentType = '';
        let currentSubType = '';
        
        // ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’è¡¨ç¤º
        function showPreviewModal(title) {
            document.getElementById('previewModalLabel').textContent = title;
            const modal = new bootstrap.Modal(document.getElementById('previewModal'));
            modal.show();
        }
        
        // ãƒãƒ£ãƒ¼ãƒˆãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼é–¢æ•°
        function previewChart(type) {
            currentType = 'chart';
            currentSubType = type;
            currentSlides = [];
            
            switch(type) {
                case 'bar':
                    currentSlides.push({
                        title: 'æœˆåˆ¥å£²ä¸Šã‚°ãƒ©ãƒ•',
                        content: `
                            <h2 class="mb-4">æœˆåˆ¥å£²ä¸Šã‚°ãƒ©ãƒ•</h2>
                            <div class="chart-container">
                                <canvas id="barChart"></canvas>
                            </div>
                        `,
                        init: () => {
                            const ctx = document.getElementById('barChart').getContext('2d');
                            new Chart(ctx, {
                                type: 'bar',
                                data: {
                                    labels: ['1æœˆ', '2æœˆ', '3æœˆ', '4æœˆ'],
                                    datasets: [{
                                        label: 'å£²ä¸Šãƒ‡ãƒ¼ã‚¿',
                                        data: [1500, 2500, 2000, 3000],
                                        backgroundColor: '#4472C4'
                                    }]
                                },
                                options: {
                                    responsive: true,
                                    maintainAspectRatio: false
                                }
                            });
                        }
                    });
                    showCode(`let pptx = new PptxGenJS();
let slide = pptx.addSlide();
slide.addChart(pptx.ChartType.bar, [
    {
        name: 'å£²ä¸Šãƒ‡ãƒ¼ã‚¿',
        labels: ['1æœˆ', '2æœˆ', '3æœˆ', '4æœˆ'],
        values: [1500, 2500, 2000, 3000]
    }
], {
    x: 1, y: 1, w: 8, h: 4,
    title: 'æœˆåˆ¥å£²ä¸Šã‚°ãƒ©ãƒ•'
});
pptx.writeFile({ fileName: 'bar-chart.pptx' });`);
                    break;
                    
                case 'line':
                    currentSlides.push({
                        title: 'å››åŠæœŸãƒˆãƒ¬ãƒ³ãƒ‰',
                        content: `
                            <h2 class="mb-4">å››åŠæœŸãƒˆãƒ¬ãƒ³ãƒ‰</h2>
                            <div class="chart-container">
                                <canvas id="lineChart"></canvas>
                            </div>
                        `,
                        init: () => {
                            const ctx = document.getElementById('lineChart').getContext('2d');
                            new Chart(ctx, {
                                type: 'line',
                                data: {
                                    labels: ['Q1', 'Q2', 'Q3', 'Q4'],
                                    datasets: [{
                                        label: 'ãƒˆãƒ¬ãƒ³ãƒ‰',
                                        data: [100, 150, 130, 180],
                                        borderColor: '#4472C4',
                                        tension: 0.1
                                    }]
                                },
                                options: {
                                    responsive: true,
                                    maintainAspectRatio: false
                                }
                            });
                        }
                    });
                    showCode(`let pptx = new PptxGenJS();
let slide = pptx.addSlide();
slide.addChart(pptx.ChartType.line, [
    {
        name: 'ãƒˆãƒ¬ãƒ³ãƒ‰',
        labels: ['Q1', 'Q2', 'Q3', 'Q4'],
        values: [100, 150, 130, 180]
    }
], {
    x: 1, y: 1, w: 8, h: 4,
    title: 'å››åŠæœŸãƒˆãƒ¬ãƒ³ãƒ‰'
});
pptx.writeFile({ fileName: 'line-chart.pptx' });`);
                    break;
                    
                case 'pie':
                    currentSlides.push({
                        title: 'å¸‚å ´ã‚·ã‚§ã‚¢åˆ†æ',
                        content: `
                            <h2 class="mb-4">å¸‚å ´ã‚·ã‚§ã‚¢åˆ†æ</h2>
                            <div class="chart-container">
                                <canvas id="pieChart"></canvas>
                            </div>
                        `,
                        init: () => {
                            const ctx = document.getElementById('pieChart').getContext('2d');
                            new Chart(ctx, {
                                type: 'pie',
                                data: {
                                    labels: ['è£½å“A', 'è£½å“B', 'è£½å“C', 'ãã®ä»–'],
                                    datasets: [{
                                        data: [35, 25, 20, 20],
                                        backgroundColor: ['#4472C4', '#ED7D31', '#A5A5A5', '#FFC000']
                                    }]
                                },
                                options: {
                                    responsive: true,
                                    maintainAspectRatio: false
                                }
                            });
                        }
                    });
                    showCode(`let pptx = new PptxGenJS();
let slide = pptx.addSlide();
slide.addChart(pptx.ChartType.pie, [
    {
        name: 'å¸‚å ´ã‚·ã‚§ã‚¢',
        labels: ['è£½å“A', 'è£½å“B', 'è£½å“C', 'ãã®ä»–'],
        values: [35, 25, 20, 20]
    }
], {
    x: 1, y: 1, w: 6, h: 4,
    title: 'å¸‚å ´ã‚·ã‚§ã‚¢åˆ†æ'
});
pptx.writeFile({ fileName: 'pie-chart.pptx' });`);
                    break;
            }
            
            currentSlideIndex = 0;
            updateSlide();
            showPreviewModal(`ãƒãƒ£ãƒ¼ãƒˆãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ - ${type}`);
        }
        
        // ãƒ†ãƒ¼ãƒ–ãƒ«ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼é–¢æ•°
        function previewTable(type) {
            currentType = 'table';
            currentSubType = type;
            currentSlides = [];
            
            switch(type) {
                case 'basic':
                    currentSlides.push({
                        title: 'åŸºæœ¬ãƒ†ãƒ¼ãƒ–ãƒ«',
                        content: `
                            <h2 class="mb-4">åŸºæœ¬ãƒ†ãƒ¼ãƒ–ãƒ«</h2>
                            <table class="preview-table">
                                <tr>
                                    <th>é …ç›®</th>
                                    <th>æ•°å€¤</th>
                                    <th>çŠ¶æ…‹</th>
                                </tr>
                                <tr>
                                    <td>å£²ä¸Š</td>
                                    <td>Â¥1,000,000</td>
                                    <td>é”æˆ</td>
                                </tr>
                                <tr>
                                    <td>ã‚³ã‚¹ãƒˆ</td>
                                    <td>Â¥500,000</td>
                                    <td>äºˆç®—å†…</td>
                                </tr>
                                <tr>
                                    <td>åˆ©ç›Š</td>
                                    <td>Â¥500,000</td>
                                    <td>è‰¯å¥½</td>
                                </tr>
                            </table>
                        `
                    });
                    showCode(`let pptx = new PptxGenJS();
let slide = pptx.addSlide();
slide.addTable([
    ['é …ç›®', 'æ•°å€¤', 'çŠ¶æ…‹'],
    ['å£²ä¸Š', 'Â¥1,000,000', 'é”æˆ'],
    ['ã‚³ã‚¹ãƒˆ', 'Â¥500,000', 'äºˆç®—å†…'],
    ['åˆ©ç›Š', 'Â¥500,000', 'è‰¯å¥½']
], {
    x: 1, y: 1, w: 8, h: 3
});
pptx.writeFile({ fileName: 'basic-table.pptx' });`);
                    break;
                    
                case 'styled':
                    currentSlides.push({
                        title: 'ã‚¹ã‚¿ã‚¤ãƒ«ä»˜ããƒ†ãƒ¼ãƒ–ãƒ«',
                        content: `
                            <h2 class="mb-4">ã‚¹ã‚¿ã‚¤ãƒ«ä»˜ããƒ†ãƒ¼ãƒ–ãƒ«</h2>
                            <table class="preview-table">
                                <tr>
                                    <th style="background-color: #363636; color: white;">ãƒ˜ãƒƒãƒ€ãƒ¼1</th>
                                    <th style="background-color: #363636; color: white;">ãƒ˜ãƒƒãƒ€ãƒ¼2</th>
                                </tr>
                                <tr>
                                    <td>ãƒ‡ãƒ¼ã‚¿1</td>
                                    <td>ãƒ‡ãƒ¼ã‚¿2</td>
                                </tr>
                                <tr>
                                    <td style="background-color: #f0f0f0;">ãƒ‡ãƒ¼ã‚¿3</td>
                                    <td style="background-color: #f0f0f0;">ãƒ‡ãƒ¼ã‚¿4</td>
                                </tr>
                            </table>
                        `
                    });
                    showCode(`let pptx = new PptxGenJS();
let slide = pptx.addSlide();
slide.addTable([
    [{ text: 'ãƒ˜ãƒƒãƒ€ãƒ¼1', options: { fill: '363636', color: 'FFFFFF', bold: true } },
     { text: 'ãƒ˜ãƒƒãƒ€ãƒ¼2', options: { fill: '363636', color: 'FFFFFF', bold: true } }],
    ['ãƒ‡ãƒ¼ã‚¿1', 'ãƒ‡ãƒ¼ã‚¿2'],
    ['ãƒ‡ãƒ¼ã‚¿3', 'ãƒ‡ãƒ¼ã‚¿4']
], {
    x: 1, y: 1, w: 8, h: 3,
    border: { pt: 1, color: 'CCCCCC' }
});
pptx.writeFile({ fileName: 'styled-table.pptx' });`);
                    break;
                    
                case 'data':
                    let rows = '<tr><th>ID</th><th>åå‰</th><th>éƒ¨é–€</th><th>å£²ä¸Š</th></tr>';
                    for(let i = 1; i <= 10; i++) {
                        rows += `<tr><td>00${i}</td><td>ç¤¾å“¡${i}</td><td>éƒ¨é–€${i % 3 + 1}</td><td>Â¥${i * 100000}</td></tr>`;
                    }
                    currentSlides.push({
                        title: 'ãƒ‡ãƒ¼ã‚¿ãƒ†ãƒ¼ãƒ–ãƒ«',
                        content: `
                            <h2 class="mb-4">ãƒ‡ãƒ¼ã‚¿ãƒ†ãƒ¼ãƒ–ãƒ«</h2>
                            <div style="overflow-y: auto; max-height: 300px;">
                                <table class="preview-table">
                                    ${rows}
                                </table>
                            </div>
                        `
                    });
                    showCode(`let pptx = new PptxGenJS();
let slide = pptx.addSlide();
let rows = [['ID', 'åå‰', 'éƒ¨é–€', 'å£²ä¸Š']];
for(let i = 1; i <= 10; i++) {
    rows.push([\`00\${i}\`, \`ç¤¾å“¡\${i}\`, \`éƒ¨é–€\${i % 3 + 1}\`, \`Â¥\${i * 100000}\`]);
}
slide.addTable(rows, {
    x: 0.5, y: 0.5, w: 9, h: 5,
    fontSize: 10
});
pptx.writeFile({ fileName: 'data-table.pptx' });`);
                    break;
                case 'evaluation':
                    currentSlides.push({
                        title: 'è©•ä¾¡ã¨èª²é¡Œ',
                        content: `
                            <div style="padding: 20px;">
                                <h2 style="font-size: 1.6rem; font-weight: bold;">4-1. å®šæ€§è©•ä¾¡</h2>
                                <h3 style="font-size: 1.2rem; font-weight: bold; margin-top: 1rem;">å®Ÿæ–½äº‹é …ã«å¯¾ã™ã‚‹è©•ä¾¡ã¨èª²é¡Œ</h3>
                                <p style="font-size: 0.9rem; margin-top: 1rem;">å„é …ç›®ã«ã¤ã„ã¦ä¸€å®šã®æˆæœã¯å¾—ã‚‰ã‚ŒãŸã‚‚ã®ã®ã€ã‚µãƒ¼ãƒ“ã‚¹åˆ©ç”¨ã®æ‹¡å¤§ã¨ãƒ‡ãƒ¼ã‚¿åé›†ã€åˆ©æ´»ç”¨ã®ä¿ƒé€²ã«å‘ã‘ã€æŠ½å‡ºã•ã‚ŒãŸèª²é¡Œã¸ã®å¯¾å¿œã‚’æ¤œè¨ã—ã€ä»Šå¾Œå®Ÿæ–½ã—ã¦ã„ãæ–¹é‡ã§ã™ã€‚</p>
                                <table class="preview-table" style="font-size: 0.75rem; margin-top: 1.5rem;">
                                    <thead>
                                        <tr>
                                            <th style="background-color: #92D050; color: #333; width: 15%;">é …ç›®</th>
                                            <th style="background-color: #92D050; color: #333; width: 25%;">è©•ä¾¡</th>
                                            <th style="background-color: #92D050; color: #333; width: 60%;">èª²é¡Œ</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td rowspan="2" style="background-color: #E2EFDA; text-align: center; font-weight: bold; vertical-align: middle;">åŒ¿ååŠ å·¥æƒ…å ±<br>ã®åé›†</td>
                                            <td rowspan="2" style="background-color: #F8F9FA; vertical-align: middle;">åŒ¿ååŠ å·¥æƒ…å ±ã«ã‚ˆã‚‹åé›†è¿½åŠ ã«ã‚ˆã‚Šã€ãƒ‡ãƒ¼ã‚¿æ•°ã¯å¢—åŠ </td>
                                            <td style="background-color: #F8F9FA;"><strong>åŒ¿ååŠ å·¥æ–¹æ³•ã®è¦‹ç›´ã—ãƒ»æ›´æ–°</strong><br>ãƒ»æœ‰è­˜è€…ã®åŠ©è¨€ã®ã‚‚ã¨é©æ³•ã«å®šç¾©æ¸ˆã¿<br>ãƒ»ãŸã ã—ä»Šå¾Œã€ãƒ‡ãƒ¼ã‚¿åˆ©æ´»ç”¨æ™‚ã«çµ„ã¿åˆã‚ã›ã‚‹æƒ…å ±ã«ã‚ˆã‚Šå€‹äººãŒç‰¹å®šã•ã‚Œã‚‹æã‚Œã‚‚ã‚ã‚Šéƒ½åº¦ãƒ‡ãƒ¼ã‚¿ç²’åº¦ã®ç²¾æŸ»ã€æ¤œè¨ç­‰ãŒå¿…è¦</td>
                                        </tr>
                                        <tr>
                                            <td style="background-color: #F8F9FA;"><strong>åŠ å·¥äº‹æ¥­è€…ã®åˆ†é›¢</strong><br>ãƒ»åŒ¿ååŠ å·¥å‡¦ç†è€…ã¨ãƒ‡ãƒ¼ã‚¿åˆ©ç”¨è€…ãŒåŒä¸€äº‹æ¥­è€…ã¨ãªã‚‹ç‚¹ã¯ã€æ¥­å‹™ç’°å¢ƒã‚’å®Œå…¨ã«åˆ†é›¢ã—ã€ãã‚Œãã‚Œå°‚ä»»ã®æ‹…å½“è€…ã‚’é…ç½®ã™ã‚‹ç­‰ã®é‹ç”¨å¯¾å¿œã«ã‚ˆã‚Šå•é¡Œãªã—ã¨ã—ãŸã‚‚ã®ã®ã€é‹ç”¨ä½“åˆ¶ã®å¤‰æ›´ç­‰ã®éš›ã«ã¯éƒ½åº¦ãƒã‚§ãƒƒã‚¯ãŒå¿…è¦</td>
                                        </tr>
                                        <tr>
                                            <td rowspan="2" style="background-color: #E2EFDA; text-align: center; font-weight: bold; vertical-align: middle;">åˆ†ææ©Ÿèƒ½<br>ã®æä¾›</td>
                                            <td rowspan="2" style="background-color: #F8F9FA; vertical-align: middle;">æ¦‚æ³ã‚’ç«¯çš„ã«æŠŠæ¡å¯èƒ½ãªãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§ã®ãƒ¬ãƒãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚’å®Ÿæ–½</td>
                                            <td style="background-color: #F8F9FA;"><strong>åˆ©ç”¨å¢—ã®å¯¾ç­–æ¤œè¨</strong><br>ãƒ»åˆ©ç”¨ä»¶æ•°ã‚’å¢—åŠ ã•ã›ã‚‹æ–½ç­–ã®æ¤œè¨ãŒå¿…è¦(ãƒ¬ãƒãƒ¼ãƒˆã®æ”¹å–„ã€ç°¡æ˜“ãªé›†è¨ˆç”»é¢ã®æä¾›ç­‰)æ¤œè¨ãŒå¿…è¦</td>
                                        </tr>
                                        <tr>
                                            <td style="background-color: #F8F9FA;"><strong>ãƒ‡ãƒ¼ã‚¿åˆ©æ´»ç”¨ã®é«˜åº¦åŒ–æ¤œè¨</strong><br>ãƒ»ãƒ†ã‚­ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã®åˆ†æã€AIã®åˆ©ç”¨ç­‰ã€é«˜åº¦ãªåˆ†æå®Ÿæ–½ã«å‘ã‘ãŸãƒ‡ãƒ¼ã‚¿æ•´å‚™ã¨å®Ÿæ–½æ–¹æ³•ã®æ¤œè¨ãŒå¿…è¦</td>
                                        </tr>
                                        <tr>
                                            <td rowspan="2" style="background-color: #E2EFDA; text-align: center; font-weight: bold; vertical-align: middle;">æ±ºæ¸ˆæ©Ÿèƒ½<br>ã®æä¾›</td>
                                            <td rowspan="2" style="background-color: #F8F9FA; vertical-align: middle;">2åœ°åŸŸã§ãã‚Œãã‚Œæ±ºæ¸ˆã‚µãƒ¼ãƒ“ã‚¹ã®æä¾›ä½“åˆ¶ã€é‹ç”¨ã‚¹ã‚­ãƒ¼ãƒ ã‚’æ§‹ç¯‰ã€å®Ÿè¨¼ã—ã€ç¤ºå”†ã‚’åé›†</td>
                                            <td style="background-color: #F8F9FA;"><strong>å°å…¥åº—èˆ—æ•°ã®æ‹¡å¤§</strong><br>ãƒ»åº—èˆ—æ•°ã®æ‹¡å¤§ã«å‘ã‘ã€å°å…¥ã®æŠµæŠ—ã¨ãªã‚‹åº—èˆ—ç«¯æœ«ã®ç”¨æ„ã€æ±ºæ¸ˆæ‰‹æ•°æ–™ã€é‹ç”¨è²»ã«å¯¾ã—ã€å°å…¥ãƒ¡ãƒªãƒƒãƒˆã®æç¤ºç­‰ã€å¯¾å¿œç­–ã®æ¤œè¨ãŒå¿…è¦</td>
                                        </tr>
                                        <tr>
                                            <td style="background-color: #F8F9FA;"><strong>ãƒ¦ãƒ¼ã‚¶åˆ©ç”¨ã®æ‹¡å¤§</strong><br>ãƒ»ãƒ¦ãƒ¼ã‚¶ã¸ã®ãƒ—ãƒ­ãƒ¢ãƒ¼ã‚·ãƒ§ãƒ³ã€åˆ©ç”¨ãƒ¡ãƒªãƒƒãƒˆã€ã‚¤ãƒ³ã‚»ãƒ³ãƒ†ã‚£ãƒ–ã®æç¤ºç­‰ã€èªçŸ¥åº¦ã®å‘ä¸Šã¨åˆ©ç”¨ä¿ƒé€²ç­–ã®æ¤œè¨ã€å®Ÿæ–½ãŒå¿…è¦</td>
                                        </tr>
                                        <tr>
                                            <td rowspan="2" style="background-color: #E2EFDA; text-align: center; font-weight: bold; vertical-align: middle;">æµ·å¤–æ³•ä»¤ã®<br>èª¿æŸ»ã¨å¯¾å¿œ</td>
                                            <td rowspan="2" style="background-color: #F8F9FA; vertical-align: middle;">æœ€æ–°å‹•å‘ã‚’æŠŠæ¡ã—ã€æœ‰è­˜è€…ã®ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã®ã‚‚ã¨å¯¾å¿œã‚’å®Ÿæ–½</td>
                                            <td style="background-color: #F8F9FA;"><strong>EEAå›½ç±ãƒ¦ãƒ¼ã‚¶ãƒ‡ãƒ¼ã‚¿ã®æ‰±ã„</strong><br>ãƒ»ç¾çŠ¶ã€ä¸€å¾‹ç ´æ£„ã¨ã—ã¦ã„ã‚‹EEAå›½ç±ãƒ¦ãƒ¼ã‚¶ã®ãƒ‡ãƒ¼ã‚¿ã«ã¤ã„ã¦ã€ã‚µãƒ¼ãƒ“ã‚¹åˆ©ç”¨ä½ç½®ã‚„ãƒ‡ãƒ¼ã‚¿é€£æºæ™‚ã®ä½ç½®æƒ…å ±ã‚’ã‚‚ã¨ã«ç ´æ£„ã®åˆ¤æ–­ã‚’å®Ÿæ–½ã™ã‚‹ä»•çµ„ã¿ã®æ¤œè¨ã€æ§‹ç¯‰</td>
                                        </tr>
                                        <tr>
                                            <td style="background-color: #F8F9FA;"><strong>ePrivacyè¦å‰‡ã¸ã®å¯¾å¿œ</strong><br>ãƒ»å”è­°æ¤œè¨ä¸­ã®ePrivacyè¦å‰‡ã«ã¤ã„ã¦ã€æ–½è¡Œã•ã‚Œæ¬¡ç¬¬æ—©æ€¥ã«å¯¾å¿œãŒå¯èƒ½ãªã‚ˆã†ã€ä»Šå¾Œã®å‹•å‘æ³¨è¦–ã‚’ç¶™ç¶šã—ã€å¯¾å¿œã‚’æ•´ç†</td>
                                        </tr>
                                    </tbody>
                                </table>
                                <div style="text-align: right; font-size: 0.8rem; margin-top: 10px; color: #666;">33</div>
                            </div>
                        `
                    });
                    showCode(`let pptx = new PptxGenJS();
let slide = pptx.addSlide();

slide.addText("4-1. å®šæ€§è©•ä¾¡", { x: 0.5, y: 0.25, w: "90%", h: 0.5, fontSize: 32, bold: true });
slide.addText("å®Ÿæ–½äº‹é …ã«å¯¾ã™ã‚‹è©•ä¾¡ã¨èª²é¡Œ", { x: 0.5, y: 0.75, w: "90%", h: 0.5, fontSize: 24, bold: true });
slide.addText("å„é …ç›®ã«ã¤ã„ã¦ä¸€å®šã®æˆæœã¯å¾—ã‚‰ã‚ŒãŸã‚‚ã®ã®ã€ã‚µãƒ¼ãƒ“ã‚¹åˆ©ç”¨ã®æ‹¡å¤§ã¨ãƒ‡ãƒ¼ã‚¿åé›†ã€åˆ©æ´»ç”¨ã®ä¿ƒé€²ã«å‘ã‘ã€æŠ½å‡ºã•ã‚ŒãŸèª²é¡Œã¸ã®å¯¾å¿œã‚’æ¤œè¨ã—ã€ä»Šå¾Œå®Ÿæ–½ã—ã¦ã„ãæ–¹é‡ã§ã™ã€‚", { x: 0.5, y: 1.5, w: "90%", h: 0.6, fontSize: 14 });

const commonCellOpts = { border: { type: 'solid', pt: 1, color: 'CCCCCC' }, valign: 'middle', fontSize: 12 };
const headerOpts = { ...commonCellOpts, fill: { color: '92D050' }, color: '333333', bold: true, align: 'center', fontSize: 14 };
const itemCellOpts = { ...commonCellOpts, fill: { color: 'E2EFDA' }, align: 'center' };
const evalCellOpts = { ...commonCellOpts, fill: { color: 'E2EFDA' } };

const tableData = [
  [{ text: "é …ç›®", options: headerOpts }, { text: "è©•ä¾¡", options: headerOpts }, { text: "èª²é¡Œ", options: headerOpts }],
  [
    { text: "åŒ¿ååŠ å·¥æƒ…å ±\\nã®åé›†", options: { ...itemCellOpts, rowspan: 2 } },
    { text: "åŒ¿ååŠ å·¥æƒ…å ±ã«ã‚ˆã‚‹åé›†è¿½åŠ ã«ã‚ˆã‚Šã€ãƒ‡ãƒ¼ã‚¿æ•°ã¯å¢—åŠ ", options: { ...evalCellOpts, rowspan: 2 } },
    { text: [{ text: 'åŒ¿ååŠ å·¥æ–¹æ³•ã®è¦‹ç›´ã—ãƒ»æ›´æ–°', options: { bold: true } }, { text: '\\nãƒ»æœ‰è­˜è€…ã®åŠ©è¨€ã®ã‚‚ã¨é©æ³•ã«å®šç¾©æ¸ˆã¿', options: { breakLine: true } }, { text: '\\nãƒ»ãŸã ã—ä»Šå¾Œã€ãƒ‡ãƒ¼ã‚¿åˆ©æ´»ç”¨æ™‚ã«çµ„ã¿åˆã‚ã›ã‚‹æƒ…å ±ã«ã‚ˆã‚Šå€‹äººãŒç‰¹å®šã•ã‚Œã‚‹æã‚Œã‚‚ã‚ã‚Šéƒ½åº¦ãƒ‡ãƒ¼ã‚¿ç²’åº¦ã®ç²¾æŸ»ã€æ¤œè¨ç­‰ãŒå¿…è¦', options: { breakLine: true } }], options: commonCellOpts },
  ],
  [ { text: [{ text: 'åŠ å·¥äº‹æ¥­è€…ã®åˆ†é›¢', options: { bold: true } }, { text: '\\nãƒ»åŒ¿ååŠ å·¥å‡¦ç†è€…ã¨ãƒ‡ãƒ¼ã‚¿åˆ©ç”¨è€…ãŒåŒä¸€äº‹æ¥­è€…ã¨ãªã‚‹ç‚¹ã¯ã€æ¥­å‹™ç’°å¢ƒã‚’å®Œå…¨ã«åˆ†é›¢ã—ã€ãã‚Œãã‚Œå°‚ä»»ã®æ‹…å½“è€…ã‚’é…ç½®ã™ã‚‹ç­‰ã®é‹ç”¨å¯¾å¿œã«ã‚ˆã‚Šå•é¡Œãªã—ã¨ã—ãŸã‚‚ã®ã®ã€é‹ç”¨ä½“åˆ¶ã®å¤‰æ›´ç­‰ã®éš›ã«ã¯éƒ½åº¦ãƒã‚§ãƒƒã‚¯ãŒå¿…è¦', options: { breakLine: true } }], options: commonCellOpts } ],
  [
    { text: "åˆ†ææ©Ÿèƒ½\\nã®æä¾›", options: { ...itemCellOpts, rowspan: 2 } },
    { text: "æ¦‚æ³ã‚’ç«¯çš„ã«æŠŠæ¡å¯èƒ½ãªãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§ã®ãƒ¬ãƒãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚’å®Ÿæ–½", options: { ...evalCellOpts, rowspan: 2 } },
    { text: [{ text: 'åˆ©ç”¨å¢—ã®å¯¾ç­–æ¤œè¨', options: { bold: true } }, { text: '\\nãƒ»åˆ©ç”¨ä»¶æ•°ã‚’å¢—åŠ ã•ã›ã‚‹æ–½ç­–ã®æ¤œè¨ãŒå¿…è¦(ãƒ¬ãƒãƒ¼ãƒˆã®æ”¹å–„ã€ç°¡æ˜“ãªé›†è¨ˆç”»é¢ã®æä¾›ç­‰)æ¤œè¨ãŒå¿…è¦', options: { breakLine: true } }], options: commonCellOpts },
  ],
  [ { text: [{ text: 'ãƒ‡ãƒ¼ã‚¿åˆ©æ´»ç”¨ã®é«˜åº¦åŒ–æ¤œè¨', options: { bold: true } }, { text: '\\nãƒ»ãƒ†ã‚­ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã®åˆ†æã€AIã®åˆ©ç”¨ç­‰ã€é«˜åº¦ãªåˆ†æå®Ÿæ–½ã«å‘ã‘ãŸãƒ‡ãƒ¼ã‚¿æ•´å‚™ã¨å®Ÿæ–½æ–¹æ³•ã®æ¤œè¨ãŒå¿…è¦', options: { breakLine: true } }], options: commonCellOpts } ],
  [
    { text: "æ±ºæ¸ˆæ©Ÿèƒ½\\nã®æä¾›", options: { ...itemCellOpts, rowspan: 2 } },
    { text: "2åœ°åŸŸã§ãã‚Œãã‚Œæ±ºæ¸ˆã‚µãƒ¼ãƒ“ã‚¹ã®æä¾›ä½“åˆ¶ã€é‹ç”¨ã‚¹ã‚­ãƒ¼ãƒ ã‚’æ§‹ç¯‰ã€å®Ÿè¨¼ã—ã€ç¤ºå”†ã‚’åé›†", options: { ...evalCellOpts, rowspan: 2 } },
    { text: [{ text: 'å°å…¥åº—èˆ—æ•°ã®æ‹¡å¤§', options: { bold: true } }, { text: '\\nãƒ»åº—èˆ—æ•°ã®æ‹¡å¤§ã«å‘ã‘ã€å°å…¥ã®æŠµæŠ—ã¨ãªã‚‹åº—èˆ—ç«¯æœ«ã®ç”¨æ„ã€æ±ºæ¸ˆæ‰‹æ•°æ–™ã€é‹ç”¨è²»ã«å¯¾ã—ã€å°å…¥ãƒ¡ãƒªãƒƒãƒˆã®æç¤ºç­‰ã€å¯¾å¿œç­–ã®æ¤œè¨ãŒå¿…è¦', options: { breakLine: true } }], options: commonCellOpts },
  ],
  [ { text: [{ text: 'ãƒ¦ãƒ¼ã‚¶åˆ©ç”¨ã®æ‹¡å¤§', options: { bold: true } }, { text: '\\nãƒ»ãƒ¦ãƒ¼ã‚¶ã¸ã®ãƒ—ãƒ­ãƒ¢ãƒ¼ã‚·ãƒ§ãƒ³ã€åˆ©ç”¨ãƒ¡ãƒªãƒƒãƒˆã€ã‚¤ãƒ³ã‚»ãƒ³ãƒ†ã‚£ãƒ–ã®æç¤ºç­‰ã€èªçŸ¥åº¦ã®å‘ä¸Šã¨åˆ©ç”¨ä¿ƒé€²ç­–ã®æ¤œè¨ã€å®Ÿæ–½ãŒå¿…è¦', options: { breakLine: true } }], options: commonCellOpts } ],
  [
    { text: "æµ·å¤–æ³•ä»¤ã®\\nèª¿æŸ»ã¨å¯¾å¿œ", options: { ...itemCellOpts, rowspan: 2 } },
    { text: "æœ€æ–°å‹•å‘ã‚’æŠŠæ¡ã—ã€æœ‰è­˜è€…ã®ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã®ã‚‚ã¨å¯¾å¿œã‚’å®Ÿæ–½", options: { ...evalCellOpts, rowspan: 2 } },
    { text: [{ text: 'EEAå›½ç±ãƒ¦ãƒ¼ã‚¶ãƒ‡ãƒ¼ã‚¿ã®æ‰±ã„', options: { bold: true } }, { text: '\\nãƒ»ç¾çŠ¶ã€ä¸€å¾‹ç ´æ£„ã¨ã—ã¦ã„ã‚‹EEAå›½ç±ãƒ¦ãƒ¼ã‚¶ã®ãƒ‡ãƒ¼ã‚¿ã«ã¤ã„ã¦ã€ã‚µãƒ¼ãƒ“ã‚¹åˆ©ç”¨ä½ç½®ã‚„ãƒ‡ãƒ¼ã‚¿é€£æºæ™‚ã®ä½ç½®æƒ…å ±ã‚’ã‚‚ã¨ã«ç ´æ£„ã®åˆ¤æ–­ã‚’å®Ÿæ–½ã™ã‚‹ä»•çµ„ã¿ã®æ¤œè¨ã€æ§‹ç¯‰', options: { breakLine: true } }], options: commonCellOpts },
  ],
  [ { text: [{ text: 'ePrivacyè¦å‰‡ã¸ã®å¯¾å¿œ', options: { bold: true } }, { text: '\\nãƒ»å”è­°æ¤œè¨ä¸­ã®ePrivacyè¦å‰‡ã«ã¤ã„ã¦ã€æ–½è¡Œã•ã‚Œæ¬¡ç¬¬æ—©æ€¥ã«å¯¾å¿œãŒå¯èƒ½ãªã‚ˆã†ã€ä»Šå¾Œã®å‹•å‘æ³¨è¦–ã‚’ç¶™ç¶šã—ã€å¯¾å¿œã‚’æ•´ç†', options: { breakLine: true } }], options: commonCellOpts } ]
];

slide.addTable(tableData, { x: 0.5, y: 2.3, w: 9.0, colW: [1.5, 2.5, 5.0] });
slide.addText('33', { x: 9.2, y: 7.1, w: 0.5, h: 0.3, align: 'right', fontSize: 10 });

pptx.writeFile({ fileName: 'Evaluation_Slide.pptx' });`);
                    break;
            }
            
            currentSlideIndex = 0;
            updateSlide();
            showPreviewModal(`ãƒ†ãƒ¼ãƒ–ãƒ«ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ - ${type}`);
        }
        
        // ã‚·ã‚§ã‚¤ãƒ—ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼é–¢æ•°
        function previewShape(type) {
            currentType = 'shape';
            currentSubType = type;
            currentSlides = [];
            
            switch(type) {
                case 'basic':
                    currentSlides.push({
                        title: 'åŸºæœ¬å›³å½¢',
                        content: `
                            <h2 class="mb-4">åŸºæœ¬å›³å½¢</h2>
                            <div class="shape-container">
                                <svg width="150" height="150" class="shape">
                                    <rect x="25" y="25" width="100" height="100" fill="#FF0000"/>
                                </svg>
                                <svg width="150" height="150" class="shape">
                                    <circle cx="75" cy="75" r="50" fill="#00FF00"/>
                                </svg>
                                <svg width="150" height="150" class="shape">
                                    <polygon points="75,25 125,125 25,125" fill="#0000FF"/>
                                </svg>
                            </div>
                        `
                    });
                    showCode(`let pptx = new PptxGenJS();
let slide = pptx.addSlide();
slide.addShape(pptx.ShapeType.rect, { x: 1, y: 1, w: 2, h: 2, fill: 'FF0000' });
slide.addShape(pptx.ShapeType.ellipse, { x: 4, y: 1, w: 2, h: 2, fill: '00FF00' });
slide.addShape(pptx.ShapeType.triangle, { x: 7, y: 1, w: 2, h: 2, fill: '0000FF' });
pptx.writeFile({ fileName: 'basic-shapes.pptx' });`);
                    break;
                    
                case 'flowchart':
                    currentSlides.push({
                        title: 'ãƒ•ãƒ­ãƒ¼ãƒãƒ£ãƒ¼ãƒˆ',
                        content: `
                            <h2 class="mb-4">ãƒ•ãƒ­ãƒ¼ãƒãƒ£ãƒ¼ãƒˆ</h2>
                            <div style="display: flex; align-items: center; justify-content: center; gap: 20px;">
                                <div style="background: #4472C4; color: white; padding: 20px 40px; border-radius: 5px;">
                                    é–‹å§‹
                                </div>
                                <div style="font-size: 30px;">â†’</div>
                                <div style="background: #FFC000; padding: 20px 40px; transform: rotate(45deg);">
                                    <div style="transform: rotate(-45deg);">æ¡ä»¶</div>
                                </div>
                                <div style="font-size: 30px;">â†’</div>
                                <div style="background: #70AD47; color: white; padding: 20px 40px; border-radius: 5px;">
                                    çµ‚äº†
                                </div>
                            </div>
                        `
                    });
                    showCode(`let pptx = new PptxGenJS();
let slide = pptx.addSlide();
// ãƒ—ãƒ­ã‚»ã‚¹ãƒœãƒƒã‚¯ã‚¹
slide.addShape(pptx.ShapeType.rect, { x: 1, y: 1, w: 2, h: 1, fill: '4472C4' });
slide.addText('é–‹å§‹', { x: 1, y: 1, w: 2, h: 1, align: 'center', valign: 'middle', color: 'FFFFFF' });
// åˆ¤æ–­ãƒœãƒƒã‚¯ã‚¹
slide.addShape(pptx.ShapeType.diamond, { x: 4, y: 0.5, w: 2, h: 2, fill: 'FFC000' });
slide.addText('æ¡ä»¶', { x: 4, y: 0.5, w: 2, h: 2, align: 'center', valign: 'middle' });
pptx.writeFile({ fileName: 'flowchart.pptx' });`);
                    break;
                    
                case 'custom':
                    currentSlides.push({
                        title: 'ã‚«ã‚¹ã‚¿ãƒ ãƒ‡ã‚¶ã‚¤ãƒ³',
                        content: `
                            <h2 class="mb-4">ã‚«ã‚¹ã‚¿ãƒ ãƒ‡ã‚¶ã‚¤ãƒ³</h2>
                            <div style="position: relative; height: 300px;">
                                <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: #E7E6E6; padding: 40px 100px; border-radius: 20px;">
                                    <h3 style="margin: 0;">ã‚«ã‚¹ã‚¿ãƒ ãƒ‡ã‚¶ã‚¤ãƒ³</h3>
                                </div>
                                <svg width="100" height="100" style="position: absolute; top: 20px; left: 20px;">
                                    <polygon points="50,15 61,35 82,35 67,50 73,71 50,57 27,71 33,50 18,35 39,35" fill="#FFD700"/>
                                </svg>
                            </div>
                        `
                    });
                    showCode(`let pptx = new PptxGenJS();
let slide = pptx.addSlide();
slide.addShape(pptx.ShapeType.roundRect, { x: 2, y: 1, w: 6, h: 3, fill: 'E7E6E6', rectRadius: 0.2 });
slide.addShape(pptx.ShapeType.star5, { x: 0.5, y: 0.5, w: 1, h: 1, fill: 'FFD700' });
slide.addText('ã‚«ã‚¹ã‚¿ãƒ ãƒ‡ã‚¶ã‚¤ãƒ³', { x: 2, y: 2, w: 6, h: 1, fontSize: 24, bold: true, align: 'center' });
pptx.writeFile({ fileName: 'custom-shapes.pptx' });`);
                    break;
            }
            
            currentSlideIndex = 0;
            updateSlide();
            showPreviewModal(`ã‚·ã‚§ã‚¤ãƒ—ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ - ${type}`);
        }
        
        // ãƒ†ã‚­ã‚¹ãƒˆãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼é–¢æ•°
        function previewText(type) {
            currentType = 'text';
            currentSubType = type;
            currentSlides = [];
            
            switch(type) {
                case 'title':
                    currentSlides.push({
                        title: 'ã‚¿ã‚¤ãƒˆãƒ«ã‚¹ãƒ©ã‚¤ãƒ‰',
                        content: `
                            <div style="text-align: center; margin-top: 80px;">
                                <h1 style="font-size: 48px; font-weight: bold; color: #363636; margin-bottom: 30px;">
                                    ã‚¤ãƒ³ãƒ‘ã‚¯ãƒˆã®ã‚ã‚‹ã‚¿ã‚¤ãƒˆãƒ«
                                </h1>
                                <h2 style="font-size: 24px; color: #666666;">
                                    ã‚µãƒ–ã‚¿ã‚¤ãƒˆãƒ«ã‚„ã‚­ãƒ£ãƒƒãƒã‚³ãƒ”ãƒ¼
                                </h2>
                            </div>
                        `
                    });
                    showCode(`let pptx = new PptxGenJS();
let slide = pptx.addSlide();
slide.addText('ã‚¤ãƒ³ãƒ‘ã‚¯ãƒˆã®ã‚ã‚‹ã‚¿ã‚¤ãƒˆãƒ«', {
    x: 0.5, y: 1.5, w: 9, h: 2,
    fontSize: 48, bold: true,
    align: 'center',
    color: '363636'
});
slide.addText('ã‚µãƒ–ã‚¿ã‚¤ãƒˆãƒ«ã‚„ã‚­ãƒ£ãƒƒãƒã‚³ãƒ”ãƒ¼', {
    x: 0.5, y: 3.5, w: 9, h: 1,
    fontSize: 24,
    align: 'center',
    color: '666666'
});
pptx.writeFile({ fileName: 'title-slide.pptx' });`);
                    break;
                    
                case 'bullets':
                    currentSlides.push({
                        title: 'ç®‡æ¡æ›¸ããƒªã‚¹ãƒˆ',
                        content: `
                            <h2 style="font-size: 24px; font-weight: bold; margin-bottom: 30px;">é‡è¦ãªãƒã‚¤ãƒ³ãƒˆ</h2>
                            <ul style="font-size: 18px; line-height: 1.8;">
                                <li>æœ€åˆã®ãƒã‚¤ãƒ³ãƒˆ</li>
                                <li>æ¬¡ã®ãƒã‚¤ãƒ³ãƒˆ
                                    <ul>
                                        <li>ã‚µãƒ–ãƒã‚¤ãƒ³ãƒˆ1</li>
                                        <li>ã‚µãƒ–ãƒã‚¤ãƒ³ãƒˆ2</li>
                                    </ul>
                                </li>
                                <li>æœ€å¾Œã®ãƒã‚¤ãƒ³ãƒˆ</li>
                            </ul>
                        `
                    });
                    showCode(`let pptx = new PptxGenJS();
let slide = pptx.addSlide();
slide.addText('é‡è¦ãªãƒã‚¤ãƒ³ãƒˆ', { x: 0.5, y: 0.5, fontSize: 24, bold: true });
slide.addText([
    { text: 'â€¢ æœ€åˆã®ãƒã‚¤ãƒ³ãƒˆ', options: { bullet: true, indentLevel: 0 } },
    { text: 'â€¢ æ¬¡ã®ãƒã‚¤ãƒ³ãƒˆ', options: { bullet: true, indentLevel: 0 } },
    { text: '  â—¦ ã‚µãƒ–ãƒã‚¤ãƒ³ãƒˆ1', options: { bullet: true, indentLevel: 1 } },
    { text: '  â—¦ ã‚µãƒ–ãƒã‚¤ãƒ³ãƒˆ2', options: { bullet: true, indentLevel: 1 } },
    { text: 'â€¢ æœ€å¾Œã®ãƒã‚¤ãƒ³ãƒˆ', options: { bullet: true, indentLevel: 0 } }
], {
    x: 0.5, y: 1.5, w: 9, h: 4,
    fontSize: 18
});
pptx.writeFile({ fileName: 'bullet-list.pptx' });`);
                    break;
                    
                case 'quote':
                    currentSlides.push({
                        title: 'å¼•ç”¨æ–‡',
                        content: `
                            <div style="background: #F5F5F5; border-left: 5px solid #4472C4; padding: 40px; margin: 40px 20px;">
                                <p style="font-size: 20px; font-style: italic; text-align: center; margin-bottom: 20px;">
                                    "æˆåŠŸã¨ã¯ã€å¤±æ•—ã‹ã‚‰å¤±æ•—ã¸ã¨æƒ…ç†±ã‚’å¤±ã‚ãšã«é€²ã‚€èƒ½åŠ›ã§ã‚ã‚‹"
                                </p>
                                <p style="text-align: right; font-size: 16px; color: #666;">
                                    - ã‚¦ã‚£ãƒ³ã‚¹ãƒˆãƒ³ãƒ»ãƒãƒ£ãƒ¼ãƒãƒ«
                                </p>
                            </div>
                        `
                    });
                    showCode(`let pptx = new PptxGenJS();
let slide = pptx.addSlide();
slide.addShape(pptx.ShapeType.rect, {
    x: 1, y: 1.5, w: 8, h: 3,
    fill: 'F5F5F5',
    line: { color: '4472C4', width: 3 }
});
slide.addText('"æˆåŠŸã¨ã¯ã€å¤±æ•—ã‹ã‚‰å¤±æ•—ã¸ã¨æƒ…ç†±ã‚’å¤±ã‚ãšã«é€²ã‚€èƒ½åŠ›ã§ã‚ã‚‹"', {
    x: 1.5, y: 2, w: 7, h: 1.5,
    fontSize: 20,
    italic: true,
    align: 'center',
    valign: 'middle'
});
slide.addText('- ã‚¦ã‚£ãƒ³ã‚¹ãƒˆãƒ³ãƒ»ãƒãƒ£ãƒ¼ãƒãƒ«', {
    x: 1.5, y: 3.5, w: 7, h: 0.5,
    fontSize: 16,
    align: 'right'
});
pptx.writeFile({ fileName: 'quote-slide.pptx' });`);
                    break;
            }
            
            currentSlideIndex = 0;
            updateSlide();
            showPreviewModal(`ãƒ†ã‚­ã‚¹ãƒˆãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ - ${type}`);
        }
        
        // AIãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼é–¢æ•°
        function previewAI(type) {
            currentType = 'ai';
            currentSubType = type;
            currentSlides = [];
            
            switch(type) {
                case 'future':
                    // ã‚¹ãƒ©ã‚¤ãƒ‰1: ã‚¿ã‚¤ãƒˆãƒ«ã‚¹ãƒ©ã‚¤ãƒ‰
                    currentSlides.push({
                        title: 'AIãŒæ‹“ãæœªæ¥ã¸ã‚ˆã†ã“ã',
                        content: `
                            <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); height: 100%; position: relative; display: flex; align-items: center; justify-content: center;">
                                <div style="color: white; text-align: center;">
                                    <h1 style="font-size: 48px; font-weight: bold; margin-bottom: 20px;">AIãŒæ‹“ãæœªæ¥ã¸ã‚ˆã†ã“ã</h1>
                                    <p style="font-size: 24px;">ãƒ†ã‚¯ãƒãƒ­ã‚¸ãƒ¼ãŒã‚‚ãŸã‚‰ã™å¤‰é©ã¨å¯èƒ½æ€§</p>
                                </div>
                            </div>
                        `
                    });
                    
                    // ã‚¹ãƒ©ã‚¤ãƒ‰2: AIã®ç¾åœ¨åœ°
                    currentSlides.push({
                        title: 'AIã®ç¾åœ¨åœ°',
                        content: `
                            <div style="padding: 20px;">
                                <div style="border-left: 5px solid #4285F4; padding-left: 20px; margin-bottom: 30px;">
                                    <h1 style="font-size: 64px; font-weight: bold; color: #0D47A1; margin-bottom: 10px;">AIã®ç¾åœ¨åœ°</h1>
                                    <h2 style="font-size: 28px; color: #37474F;">ç”ŸæˆAIãŒã‚‚ãŸã‚‰ã—ãŸé©å‘½</h2>
                                </div>
                                <div style="background: #E3F2FD; border-radius: 10px; padding: 30px; margin-top: 30px; text-align: center;">
                                    <div style="font-size: 80px; margin-bottom: 20px;">ğŸ§ </div>
                                    <p style="font-size: 18px; color: #1565C0;">æŠ½è±¡çš„ãªäººå·¥çŸ¥èƒ½ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®ã‚¤ãƒ¡ãƒ¼ã‚¸</p>
                                </div>
                            </div>
                        `
                    });
                    
                    // ã‚¹ãƒ©ã‚¤ãƒ‰3: ç¤¾ä¼šå®Ÿè£…ã®æœ€å‰ç·š
                    currentSlides.push({
                        title: 'ç¤¾ä¼šå®Ÿè£…ã®æœ€å‰ç·š',
                        content: `
                            <div style="padding: 20px;">
                                <h1 style="font-size: 36px; font-weight: bold; color: #1F2937; text-align: center; margin-bottom: 30px;">ç¤¾ä¼šå®Ÿè£…ã®æœ€å‰ç·šï¼šAIã¯ã©ã“ã§æ´»èºã—ã¦ã„ã‚‹ã‹ï¼Ÿ</h1>
                                <div style="display: flex; justify-content: space-around; margin-top: 40px;">
                                    <div style="background: white; border-radius: 10px; padding: 20px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); text-align: center; width: 30%;">
                                        <div style="font-size: 48px; margin-bottom: 15px;">ğŸ¥</div>
                                        <h3 style="font-size: 18px; font-weight: bold; color: #374151; margin-bottom: 10px;">åŒ»ç™‚åˆ†é‡</h3>
                                        <p style="font-size: 14px; color: #4B5563;">ç”»åƒè¨ºæ–­æ”¯æ´ã‚„å‰µè–¬ãƒ—ãƒ­ã‚»ã‚¹ã®é«˜é€ŸåŒ–ã«è²¢çŒ®ã—ã¾ã™ã€‚</p>
                                    </div>
                                    <div style="background: white; border-radius: 10px; padding: 20px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); text-align: center; width: 30%;">
                                        <div style="font-size: 48px; margin-bottom: 15px;">ğŸš—</div>
                                        <h3 style="font-size: 18px; font-weight: bold; color: #374151; margin-bottom: 10px;">è‡ªå‹•é‹è»¢</h3>
                                        <p style="font-size: 14px; color: #4B5563;">å‘¨å›²ã®ç’°å¢ƒã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§èªè­˜ã—ã€å®‰å…¨ãªèµ°è¡Œã‚’å®Ÿç¾ã—ã¾ã™ã€‚</p>
                                    </div>
                                    <div style="background: white; border-radius: 10px; padding: 20px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); text-align: center; width: 30%;">
                                        <div style="font-size: 48px; margin-bottom: 15px;">ğŸ’°</div>
                                        <h3 style="font-size: 18px; font-weight: bold; color: #374151; margin-bottom: 10px;">é‡‘èãƒ»çµŒæ¸ˆ</h3>
                                        <p style="font-size: 14px; color: #4B5563;">å¸‚å ´äºˆæ¸¬ã‚„ä¸æ­£æ¤œçŸ¥ã€ãƒ‘ãƒ¼ã‚½ãƒŠãƒ©ã‚¤ã‚ºã•ã‚ŒãŸã‚¢ãƒ‰ãƒã‚¤ã‚¹ã‚’æä¾›ã—ã¾ã™ã€‚</p>
                                    </div>
                                </div>
                            </div>
                        `
                    });
                    
                    // ã‚¹ãƒ©ã‚¤ãƒ‰4: 2030å¹´ã®AI
                    currentSlides.push({
                        title: '2030å¹´ã®AIï¼šæœªæ¥äºˆæ¸¬ã¨å€«ç†çš„èª²é¡Œ',
                        content: `
                            <div style="padding: 20px; text-align: center;">
                                <h1 style="font-size: 48px; font-weight: bold; color: #1C3A5E; margin-bottom: 20px;">2030å¹´ã®AIï¼šæœªæ¥äºˆæ¸¬ã¨å€«ç†çš„èª²é¡Œ</h1>
                                <div style="width: 150px; height: 3px; background: #4A90E2; margin: 0 auto 40px;"></div>
                                <div style="background: #F0F4F8; border-radius: 15px; padding: 40px; margin: 20px 0;">
                                    <div style="font-size: 120px; margin-bottom: 20px;">ğŸ”®</div>
                                    <p style="font-size: 18px; color: #1565C0;">æœªæ¥ã®ãƒ†ã‚¯ãƒãƒ­ã‚¸ãƒ¼ã¨äººå·¥çŸ¥èƒ½ã®æŠ½è±¡çš„ãªè¡¨ç¾</p>
                                </div>
                            </div>
                        `
                    });
                    
                    // ã‚¹ãƒ©ã‚¤ãƒ‰5: ã¾ã¨ã‚
                    currentSlides.push({
                        title: 'ã¾ã¨ã‚ï¼šAIã¨å…±å­˜ã™ã‚‹æœªæ¥ã‚’ã©ã†å‰µã‚‹ã‹',
                        content: `
                            <div style="padding: 20px;">
                                <h1 style="font-size: 36px; font-weight: bold; color: #0F172A; margin-bottom: 30px;">ã¾ã¨ã‚ï¼šAIã¨å…±å­˜ã™ã‚‹æœªæ¥ã‚’ã©ã†å‰µã‚‹ã‹</h1>
                                <div style="width: 320px; height: 2px; background: #3B82F6; margin-bottom: 30px;"></div>
                                <div style="display: flex; align-items: center; gap: 40px;">
                                    <div style="flex: 1;">
                                        <ul style="font-size: 22px; color: #334155; line-height: 2;">
                                            <li>ç¶™ç¶šçš„ãªå­¦ç¿’ã¨é©å¿œ</li>
                                            <li>å€«ç†çš„æŒ‡é‡ã®ç¢ºç«‹ã¨å®Ÿè·µ</li>
                                            <li>äººé–“ã¨AIã®å”åƒã«ã‚ˆã‚‹ä¾¡å€¤å‰µé€ </li>
                                        </ul>
                                    </div>
                                    <div style="flex: 1; text-align: center;">
                                        <div style="font-size: 150px;">ğŸ¤</div>
                                        <p style="font-size: 16px; color: #6B7280; margin-top: 20px;">äººå·¥çŸ¥èƒ½ã¨äººé–“ã®å”åŠ›ã‚’è±¡å¾´ã™ã‚‹ã‚¤ãƒ¡ãƒ¼ã‚¸</p>
                                    </div>
                                </div>
                            </div>
                        `
                    });
                    
                    showCode(`let pptx = new PptxGenJS();
// ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³è¨­å®š
pptx.layout = 'LAYOUT_WIDE';
pptx.title = 'AIãŒæ‹“ãæœªæ¥ï¼šç§ãŸã¡ã®ç”Ÿæ´»ã¨ç¤¾ä¼šã¯ã©ã†å¤‰ã‚ã‚‹ã‹ï¼Ÿ';
pptx.author = 'AI Slide Generator';
pptx.company = 'AI-Powered Presentation System';

// ã‚¹ãƒ©ã‚¤ãƒ‰1: ã‚¿ã‚¤ãƒˆãƒ«
let slide1 = pptx.addSlide();
slide1.background = { path: 'https://images.unsplash.com/photo-1646153389640-958d7ba1a864' };
slide1.addShape('rect', { x: 0, y: 0, w: '100%', h: '100%', fill: { color: '000000', transparency: 60 } });
slide1.addText('AIãŒæ‹“ãæœªæ¥ã¸ã‚ˆã†ã“ã', { x: '5%', y: '35%', w: '90%', h: '15%', fontSize: 48, bold: true, color: 'FFFFFF', align: 'center' });
slide1.addText('ãƒ†ã‚¯ãƒãƒ­ã‚¸ãƒ¼ãŒã‚‚ãŸã‚‰ã™å¤‰é©ã¨å¯èƒ½æ€§', { x: '5%', y: '52%', w: '90%', h: '10%', fontSize: 24, color: 'E0E0E0', align: 'center' });

// ã‚¹ãƒ©ã‚¤ãƒ‰2-5: è©³ç´°å†…å®¹...
pptx.writeFile({ fileName: 'AI-Future-Presentation.pptx' });`);
                    break;
                    
                case 'innovation':
                    // æŠ€è¡“é©æ–°ç‰ˆã®ã‚¹ãƒ©ã‚¤ãƒ‰ï¼ˆåŒæ§˜ã®æ§‹é€ ã§ç•°ãªã‚‹ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ï¼‰
                    currentSlides.push({
                        title: 'æŠ€è¡“é©æ–°ã¨ç¤¾ä¼šå¤‰é©',
                        content: `
                            <div style="background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%); height: 100%; position: relative; display: flex; align-items: center; justify-content: center;">
                                <div style="color: white; text-align: center;">
                                    <h1 style="font-size: 48px; font-weight: bold; margin-bottom: 20px;">æŠ€è¡“é©æ–°ã¨ç¤¾ä¼šå¤‰é©</h1>
                                    <p style="font-size: 24px;">AIãŒåˆ‡ã‚Šæ‹“ãæ–°ãŸãªå¯èƒ½æ€§</p>
                                </div>
                            </div>
                        `
                    });
                    
                    showCode(`let pptx = new PptxGenJS();
pptx.layout = 'LAYOUT_WIDE';
pptx.title = 'æŠ€è¡“é©æ–°ã¨ç¤¾ä¼šå¤‰é©';
pptx.author = 'AI Innovation Team';

// æŠ€è¡“é©æ–°ã‚’ãƒ†ãƒ¼ãƒã«ã—ãŸãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³
let slide1 = pptx.addSlide();
slide1.background = { fill: { type: 'gradient', colors: ['11998e', '38ef7d'], angle: 135 } };
slide1.addText('æŠ€è¡“é©æ–°ã¨ç¤¾ä¼šå¤‰é©', { x: '5%', y: '35%', w: '90%', h: '15%', fontSize: 48, bold: true, color: 'FFFFFF', align: 'center' });

pptx.writeFile({ fileName: 'AI-Innovation-Presentation.pptx' });`);
                    break;
            }
            
            currentSlideIndex = 0;
            updateSlide();
            showPreviewModal(`AIãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ - ${type}`);
        }
        
        // ã‚¹ãƒ©ã‚¤ãƒ‰ã®æ›´æ–°
        function updateSlide() {
            if (currentSlides.length === 0) return;
            
            const slide = currentSlides[currentSlideIndex];
            document.getElementById('slideContent').innerHTML = slide.content;
            document.getElementById('slideIndicator').textContent = `${currentSlideIndex + 1} / ${currentSlides.length}`;
            
            // å‰å¾Œãƒœã‚¿ãƒ³ã®æœ‰åŠ¹/ç„¡åŠ¹åŒ–
            document.getElementById('prevBtn').disabled = currentSlideIndex === 0;
            document.getElementById('nextBtn').disabled = currentSlideIndex === currentSlides.length - 1;
            
            // ã‚¹ãƒ©ã‚¤ãƒ‰å›ºæœ‰ã®åˆæœŸåŒ–å‡¦ç†ãŒã‚ã‚Œã°å®Ÿè¡Œ
            if (slide.init) {
                setTimeout(slide.init, 100);
            }
        }
        
        // å‰ã®ã‚¹ãƒ©ã‚¤ãƒ‰
        function previousSlide() {
            if (currentSlideIndex > 0) {
                currentSlideIndex--;
                updateSlide();
            }
        }
        
        // æ¬¡ã®ã‚¹ãƒ©ã‚¤ãƒ‰
        function nextSlide() {
            if (currentSlideIndex < currentSlides.length - 1) {
                currentSlideIndex++;
                updateSlide();
            }
        }
        
        // ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒœã‚¿ãƒ³ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©
        document.getElementById('downloadBtn').addEventListener('click', function() {
            switch(currentType) {
                case 'chart':
                    generateChart(currentSubType);
                    break;
                case 'table':
                    generateTable(currentSubType);
                    break;
                case 'shape':
                    generateShape(currentSubType);
                    break;
                case 'text':
                    generateText(currentSubType);
                    break;
                case 'ai':
                    generateAI(currentSubType);
                    break;
            }
            bootstrap.Modal.getInstance(document.getElementById('previewModal')).hide();
        });
        
        // ä»¥ä¸‹ã€å…ƒã®generateé–¢æ•°ã‚’ãã®ã¾ã¾ä½¿ç”¨
        
        // ãƒãƒ£ãƒ¼ãƒˆç”Ÿæˆé–¢æ•°
        function generateChart(type) {
            let pptx = new PptxGenJS();
            let slide = pptx.addSlide();
            
            switch(type) {
                case 'bar':
                    slide.addChart(pptx.ChartType.bar, [
                        {
                            name: 'å£²ä¸Šãƒ‡ãƒ¼ã‚¿',
                            labels: ['1æœˆ', '2æœˆ', '3æœˆ', '4æœˆ'],
                            values: [1500, 2500, 2000, 3000]
                        }
                    ], {
                        x: 1, y: 1, w: 8, h: 4,
                        title: 'æœˆåˆ¥å£²ä¸Šã‚°ãƒ©ãƒ•'
                    });
                    break;
                    
                case 'line':
                    slide.addChart(pptx.ChartType.line, [
                        {
                            name: 'ãƒˆãƒ¬ãƒ³ãƒ‰',
                            labels: ['Q1', 'Q2', 'Q3', 'Q4'],
                            values: [100, 150, 130, 180]
                        }
                    ], {
                        x: 1, y: 1, w: 8, h: 4,
                        title: 'å››åŠæœŸãƒˆãƒ¬ãƒ³ãƒ‰'
                    });
                    break;
                    
                case 'pie':
                    slide.addChart(pptx.ChartType.pie, [
                        {
                            name: 'å¸‚å ´ã‚·ã‚§ã‚¢',
                            labels: ['è£½å“A', 'è£½å“B', 'è£½å“C', 'ãã®ä»–'],
                            values: [35, 25, 20, 20]
                        }
                    ], {
                        x: 1, y: 1, w: 6, h: 4,
                        title: 'å¸‚å ´ã‚·ã‚§ã‚¢åˆ†æ'
                    });
                    break;
            }
            
            pptx.writeFile({ fileName: `${type}-chart-demo.pptx` });
        }
        
        // ãƒ†ãƒ¼ãƒ–ãƒ«ç”Ÿæˆé–¢æ•°
        function generateTable(type) {
            let pptx = new PptxGenJS();
            let slide = pptx.addSlide();
            
            switch(type) {
                case 'basic':
                    slide.addTable([
                        ['é …ç›®', 'æ•°å€¤', 'çŠ¶æ…‹'],
                        ['å£²ä¸Š', 'Â¥1,000,000', 'é”æˆ'],
                        ['ã‚³ã‚¹ãƒˆ', 'Â¥500,000', 'äºˆç®—å†…'],
                        ['åˆ©ç›Š', 'Â¥500,000', 'è‰¯å¥½']
                    ], {
                        x: 1, y: 1, w: 8, h: 3
                    });
                    break;
                    
                case 'styled':
                    slide.addTable([
                        [{ text: 'ãƒ˜ãƒƒãƒ€ãƒ¼1', options: { fill: '363636', color: 'FFFFFF', bold: true } },
                         { text: 'ãƒ˜ãƒƒãƒ€ãƒ¼2', options: { fill: '363636', color: 'FFFFFF', bold: true } }],
                        ['ãƒ‡ãƒ¼ã‚¿1', 'ãƒ‡ãƒ¼ã‚¿2'],
                        ['ãƒ‡ãƒ¼ã‚¿3', 'ãƒ‡ãƒ¼ã‚¿4']
                    ], {
                        x: 1, y: 1, w: 8, h: 3,
                        border: { pt: 1, color: 'CCCCCC' }
                    });
                    break;
                    
                case 'data':
                    let rows = [['ID', 'åå‰', 'éƒ¨é–€', 'å£²ä¸Š']];
                    for(let i = 1; i <= 10; i++) {
                        rows.push([`00${i}`, `ç¤¾å“¡${i}`, `éƒ¨é–€${i % 3 + 1}`, `Â¥${i * 100000}`]);
                    }
                    slide.addTable(rows, {
                        x: 0.5, y: 0.5, w: 9, h: 5,
                        fontSize: 10
                    });
                    break;
                case 'evaluation':
                    {
                        slide.addText("4-1. å®šæ€§è©•ä¾¡", { x: 0.5, y: 0.25, w: "90%", h: 0.5, fontSize: 32, bold: true });
                        slide.addText("å®Ÿæ–½äº‹é …ã«å¯¾ã™ã‚‹è©•ä¾¡ã¨èª²é¡Œ", { x: 0.5, y: 0.75, w: "90%", h: 0.5, fontSize: 24, bold: true });
                        slide.addText(
                            "å„é …ç›®ã«ã¤ã„ã¦ä¸€å®šã®æˆæœã¯å¾—ã‚‰ã‚ŒãŸã‚‚ã®ã®ã€ã‚µãƒ¼ãƒ“ã‚¹åˆ©ç”¨ã®æ‹¡å¤§ã¨ãƒ‡ãƒ¼ã‚¿åé›†ã€åˆ©æ´»ç”¨ã®ä¿ƒé€²ã«å‘ã‘ã€æŠ½å‡ºã•ã‚ŒãŸèª²é¡Œã¸ã®å¯¾å¿œã‚’æ¤œè¨ã—ã€ä»Šå¾Œå®Ÿæ–½ã—ã¦ã„ãæ–¹é‡ã§ã™ã€‚", { x: 0.5, y: 1.5, w: "90%", h: 0.6, fontSize: 14 }
                        );

                        const commonCellOpts = {
                            border: { type: 'solid', pt: 1, color: 'CCCCCC' },
                            valign: 'middle',
                            fontSize: 12,
                        };

                        const headerOpts = {
                            ...commonCellOpts,
                            fill: { color: '92D050' },
                            color: '333333',
                            bold: true,
                            align: 'center',
                            fontSize: 14,
                        };

                        const itemCellOpts = {
                            ...commonCellOpts,
                            fill: { color: 'E2EFDA' },
                            align: 'center',
                        };

                        const evalCellOpts = {
                            ...commonCellOpts,
                            fill: { color: 'E2EFDA' },
                        };

                        const tableData = [
                            [{ text: "é …ç›®", options: headerOpts }, { text: "è©•ä¾¡", options: headerOpts }, { text: "èª²é¡Œ", options: headerOpts }],
                            [
                                { text: "åŒ¿ååŠ å·¥æƒ…å ±\nã®åé›†", options: { ...itemCellOpts, rowspan: 2 } },
                                { text: "åŒ¿ååŠ å·¥æƒ…å ±ã«ã‚ˆã‚‹åé›†è¿½åŠ ã«ã‚ˆã‚Šã€ãƒ‡ãƒ¼ã‚¿æ•°ã¯å¢—åŠ ", options: { ...evalCellOpts, rowspan: 2 } },
                                { text: [{ text: 'åŒ¿ååŠ å·¥æ–¹æ³•ã®è¦‹ç›´ã—ãƒ»æ›´æ–°', options: { bold: true, color: '333333' } }, { text: '\nãƒ»æœ‰è­˜è€…ã®åŠ©è¨€ã®ã‚‚ã¨é©æ³•ã«å®šç¾©æ¸ˆã¿', options: { breakLine: true } }, { text: '\nãƒ»ãŸã ã—ä»Šå¾Œã€ãƒ‡ãƒ¼ã‚¿åˆ©æ´»ç”¨æ™‚ã«çµ„ã¿åˆã‚ã›ã‚‹æƒ…å ±ã«ã‚ˆã‚Šå€‹äººãŒç‰¹å®šã•ã‚Œã‚‹æã‚Œã‚‚ã‚ã‚Šéƒ½åº¦ãƒ‡ãƒ¼ã‚¿ç²’åº¦ã®ç²¾æŸ»ã€æ¤œè¨ç­‰ãŒå¿…è¦', options: { breakLine: true } }], options: commonCellOpts },
                            ],
                            [{
                                text: [{ text: 'åŠ å·¥äº‹æ¥­è€…ã®åˆ†é›¢', options: { bold: true, color: '333333' } }, { text: '\nãƒ»åŒ¿ååŠ å·¥å‡¦ç†è€…ã¨ãƒ‡ãƒ¼ã‚¿åˆ©ç”¨è€…ãŒåŒä¸€äº‹æ¥­è€…ã¨ãªã‚‹ç‚¹ã¯ã€æ¥­å‹™ç’°å¢ƒã‚’å®Œå…¨ã«åˆ†é›¢ã—ã€ãã‚Œãã‚Œå°‚ä»»ã®æ‹…å½“è€…ã‚’é…ç½®ã™ã‚‹ç­‰ã®é‹ç”¨å¯¾å¿œã«ã‚ˆã‚Šå•é¡Œãªã—ã¨ã—ãŸã‚‚ã®ã®ã€é‹ç”¨ä½“åˆ¶ã®å¤‰æ›´ç­‰ã®éš›ã«ã¯éƒ½åº¦ãƒã‚§ãƒƒã‚¯ãŒå¿…è¦', options: { breakLine: true } }],
                                options: commonCellOpts
                            }, ],
                            [
                                { text: "åˆ†ææ©Ÿèƒ½\nã®æä¾›", options: { ...itemCellOpts, rowspan: 2 } },
                                { text: "æ¦‚æ³ã‚’ç«¯çš„ã«æŠŠæ¡å¯èƒ½ãªãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§ã®ãƒ¬ãƒãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚’å®Ÿæ–½", options: { ...evalCellOpts, rowspan: 2 } },
                                { text: [{ text: 'åˆ©ç”¨å¢—ã®å¯¾ç­–æ¤œè¨', options: { bold: true, color: '333333' } }, { text: '\nãƒ»åˆ©ç”¨ä»¶æ•°ã‚’å¢—åŠ ã•ã›ã‚‹æ–½ç­–ã®æ¤œè¨ãŒå¿…è¦(ãƒ¬ãƒãƒ¼ãƒˆã®æ”¹å–„ã€ç°¡æ˜“ãªé›†è¨ˆç”»é¢ã®æä¾›ç­‰)æ¤œè¨ãŒå¿…è¦', options: { breakLine: true } }], options: commonCellOpts },
                            ],
                            [{
                                text: [{ text: 'ãƒ‡ãƒ¼ã‚¿åˆ©æ´»ç”¨ã®é«˜åº¦åŒ–æ¤œè¨', options: { bold: true, color: '333333' } }, { text: '\nãƒ»ãƒ†ã‚­ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã®åˆ†æã€AIã®åˆ©ç”¨ç­‰ã€é«˜åº¦ãªåˆ†æå®Ÿæ–½ã«å‘ã‘ãŸãƒ‡ãƒ¼ã‚¿æ•´å‚™ã¨å®Ÿæ–½æ–¹æ³•ã®æ¤œè¨ãŒå¿…è¦', options: { breakLine: true } }],
                                options: commonCellOpts
                            }, ],
                            [
                                { text: "æ±ºæ¸ˆæ©Ÿèƒ½\nã®æä¾›", options: { ...itemCellOpts, rowspan: 2 } },
                                { text: "2åœ°åŸŸã§ãã‚Œãã‚Œæ±ºæ¸ˆã‚µãƒ¼ãƒ“ã‚¹ã®æä¾›ä½“åˆ¶ã€é‹ç”¨ã‚¹ã‚­ãƒ¼ãƒ ã‚’æ§‹ç¯‰ã€å®Ÿè¨¼ã—ã€ç¤ºå”†ã‚’åé›†", options: { ...evalCellOpts, rowspan: 2 } },
                                { text: [{ text: 'å°å…¥åº—èˆ—æ•°ã®æ‹¡å¤§', options: { bold: true, color: '333333' } }, { text: '\nãƒ»åº—èˆ—æ•°ã®æ‹¡å¤§ã«å‘ã‘ã€å°å…¥ã®æŠµæŠ—ã¨ãªã‚‹åº—èˆ—ç«¯æœ«ã®ç”¨æ„ã€æ±ºæ¸ˆæ‰‹æ•°æ–™ã€é‹ç”¨è²»ã«å¯¾ã—ã€å°å…¥ãƒ¡ãƒªãƒƒãƒˆã®æç¤ºç­‰ã€å¯¾å¿œç­–ã®æ¤œè¨ãŒå¿…è¦', options: { breakLine: true } }], options: commonCellOpts },
                            ],
                            [{
                                text: [{ text: 'ãƒ¦ãƒ¼ã‚¶åˆ©ç”¨ã®æ‹¡å¤§', options: { bold: true, color: '333333' } }, { text: '\nãƒ»ãƒ¦ãƒ¼ã‚¶ã¸ã®ãƒ—ãƒ­ãƒ¢ãƒ¼ã‚·ãƒ§ãƒ³ã€åˆ©ç”¨ãƒ¡ãƒªãƒƒãƒˆã€ã‚¤ãƒ³ã‚»ãƒ³ãƒ†ã‚£ãƒ–ã®æç¤ºç­‰ã€èªçŸ¥åº¦ã®å‘ä¸Šã¨åˆ©ç”¨ä¿ƒé€²ç­–ã®æ¤œè¨ã€å®Ÿæ–½ãŒå¿…è¦', options: { breakLine: true } }],
                                options: commonCellOpts
                            }, ],
                            [
                                { text: "æµ·å¤–æ³•ä»¤ã®\nèª¿æŸ»ã¨å¯¾å¿œ", options: { ...itemCellOpts, rowspan: 2 } },
                                { text: "æœ€æ–°å‹•å‘ã‚’æŠŠæ¡ã—ã€æœ‰è­˜è€…ã®ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã®ã‚‚ã¨å¯¾å¿œã‚’å®Ÿæ–½", options: { ...evalCellOpts, rowspan: 2 } },
                                { text: [{ text: 'EEAå›½ç±ãƒ¦ãƒ¼ã‚¶ãƒ‡ãƒ¼ã‚¿ã®æ‰±ã„', options: { bold: true, color: '333333' } }, { text: '\nãƒ»ç¾çŠ¶ã€ä¸€å¾‹ç ´æ£„ã¨ã—ã¦ã„ã‚‹EEAå›½ç±ãƒ¦ãƒ¼ã‚¶ã®ãƒ‡ãƒ¼ã‚¿ã«ã¤ã„ã¦ã€ã‚µãƒ¼ãƒ“ã‚¹åˆ©ç”¨ä½ç½®ã‚„ãƒ‡ãƒ¼ã‚¿é€£æºæ™‚ã®ä½ç½®æƒ…å ±ã‚’ã‚‚ã¨ã«ç ´æ£„ã®åˆ¤æ–­ã‚’å®Ÿæ–½ã™ã‚‹ä»•çµ„ã¿ã®æ¤œè¨ã€æ§‹ç¯‰', options: { breakLine: true } }], options: commonCellOpts },
                            ],
                            [{
                                text: [{ text: 'ePrivacyè¦å‰‡ã¸ã®å¯¾å¿œ', options: { bold: true, color: '333333' } }, { text: '\nãƒ»å”è­°æ¤œè¨ä¸­ã®ePrivacyè¦å‰‡ã«ã¤ã„ã¦ã€æ–½è¡Œã•ã‚Œæ¬¡ç¬¬æ—©æ€¥ã«å¯¾å¿œãŒå¯èƒ½ãªã‚ˆã†ã€ä»Šå¾Œã®å‹•å‘æ³¨è¦–ã‚’ç¶™ç¶šã—ã€å¯¾å¿œã‚’æ•´ç†', options: { breakLine: true } }],
                                options: commonCellOpts
                            }, ],
                        ];

                        slide.addTable(tableData, {
                            x: 0.5,
                            y: 2.3,
                            w: 9.0,
                            colW: [1.5, 2.5, 5.0],
                        });

                        slide.addText('33', { x: 9.2, y: 7.1, w: 0.5, h: 0.3, align: 'right', fontSize: 10 });
                    }
                    break;
            }
            
            pptx.writeFile({ fileName: `${type}-table-demo.pptx` });
        }
        
        // ã‚·ã‚§ã‚¤ãƒ—ç”Ÿæˆé–¢æ•°
        function generateShape(type) {
            let pptx = new PptxGenJS();
            let slide = pptx.addSlide();
            
            switch(type) {
                case 'basic':
                    slide.addShape(pptx.ShapeType.rect, { x: 1, y: 1, w: 2, h: 2, fill: 'FF0000' });
                    slide.addShape(pptx.ShapeType.ellipse, { x: 4, y: 1, w: 2, h: 2, fill: '00FF00' });
                    slide.addShape(pptx.ShapeType.triangle, { x: 7, y: 1, w: 2, h: 2, fill: '0000FF' });
                    break;
                    
                case 'flowchart':
                    // ãƒ—ãƒ­ã‚»ã‚¹
                    slide.addShape(pptx.ShapeType.rect, { x: 1, y: 1, w: 2, h: 1, fill: '4472C4' });
                    slide.addText('é–‹å§‹', { x: 1, y: 1, w: 2, h: 1, align: 'center', valign: 'middle', color: 'FFFFFF' });
                    
                    // çŸ¢å°
                    slide.addShape(pptx.ShapeType.line, { x: 3, y: 1.5, w: 1, h: 0, line: { color: '000000', width: 2 } });
                    
                    // åˆ¤æ–­
                    slide.addShape(pptx.ShapeType.diamond, { x: 4, y: 0.5, w: 2, h: 2, fill: 'FFC000' });
                    slide.addText('æ¡ä»¶', { x: 4, y: 0.5, w: 2, h: 2, align: 'center', valign: 'middle' });
                    break;
                    
                case 'custom':
                    // ã‚«ã‚¹ã‚¿ãƒ å›³å½¢ã®çµ„ã¿åˆã‚ã›
                    slide.addShape(pptx.ShapeType.roundRect, { x: 2, y: 1, w: 6, h: 3, fill: 'E7E6E6', rectRadius: 0.2 });
                    slide.addShape(pptx.ShapeType.star5, { x: 0.5, y: 0.5, w: 1, h: 1, fill: 'FFD700' });
                    slide.addText('ã‚«ã‚¹ã‚¿ãƒ ãƒ‡ã‚¶ã‚¤ãƒ³', { x: 2, y: 2, w: 6, h: 1, fontSize: 24, bold: true, align: 'center' });
                    break;
            }
            
            pptx.writeFile({ fileName: `${type}-shape-demo.pptx` });
        }
        
        // ãƒ†ã‚­ã‚¹ãƒˆç”Ÿæˆé–¢æ•°
        function generateText(type) {
            let pptx = new PptxGenJS();
            let slide = pptx.addSlide();
            
            switch(type) {
                case 'title':
                    slide.addText('ã‚¤ãƒ³ãƒ‘ã‚¯ãƒˆã®ã‚ã‚‹ã‚¿ã‚¤ãƒˆãƒ«', {
                        x: 0.5, y: 1.5, w: 9, h: 2,
                        fontSize: 48, bold: true,
                        align: 'center',
                        color: '363636'
                    });
                    slide.addText('ã‚µãƒ–ã‚¿ã‚¤ãƒˆãƒ«ã‚„ã‚­ãƒ£ãƒƒãƒã‚³ãƒ”ãƒ¼', {
                        x: 0.5, y: 3.5, w: 9, h: 1,
                        fontSize: 24,
                        align: 'center',
                        color: '666666'
                    });
                    break;
                    
                case 'bullets':
                    slide.addText('é‡è¦ãªãƒã‚¤ãƒ³ãƒˆ', { x: 0.5, y: 0.5, fontSize: 24, bold: true });
                    slide.addText([
                        { text: 'â€¢ æœ€åˆã®ãƒã‚¤ãƒ³ãƒˆ', options: { bullet: true, indentLevel: 0 } },
                        { text: 'â€¢ æ¬¡ã®ãƒã‚¤ãƒ³ãƒˆ', options: { bullet: true, indentLevel: 0 } },
                        { text: '  â—¦ ã‚µãƒ–ãƒã‚¤ãƒ³ãƒˆ1', options: { bullet: true, indentLevel: 1 } },
                        { text: '  â—¦ ã‚µãƒ–ãƒã‚¤ãƒ³ãƒˆ2', options: { bullet: true, indentLevel: 1 } },
                        { text: 'â€¢ æœ€å¾Œã®ãƒã‚¤ãƒ³ãƒˆ', options: { bullet: true, indentLevel: 0 } }
                    ], {
                        x: 0.5, y: 1.5, w: 9, h: 4,
                        fontSize: 18,
                        lineSpacing: 24
                    });
                    break;
                    
                case 'quote':
                    slide.addShape(pptx.ShapeType.rect, {
                        x: 1, y: 1.5, w: 8, h: 3,
                        fill: 'F5F5F5',
                        line: { color: '4472C4', width: 3 }
                    });
                    slide.addText('"æˆåŠŸã¨ã¯ã€å¤±æ•—ã‹ã‚‰å¤±æ•—ã¸ã¨æƒ…ç†±ã‚’å¤±ã‚ãšã«é€²ã‚€èƒ½åŠ›ã§ã‚ã‚‹"', {
                        x: 1.5, y: 2, w: 7, h: 1.5,
                        fontSize: 20,
                        italic: true,
                        align: 'center',
                        valign: 'middle'
                    });
                    slide.addText('- ã‚¦ã‚£ãƒ³ã‚¹ãƒˆãƒ³ãƒ»ãƒãƒ£ãƒ¼ãƒãƒ«', {
                        x: 1.5, y: 3.5, w: 7, h: 0.5,
                        fontSize: 16,
                        align: 'right'
                    });
                    break;
            }
            
            pptx.writeFile({ fileName: `${type}-text-demo.pptx` });
        }
        
        // AIãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ç”Ÿæˆé–¢æ•°
        function generateAI(type) {
            let pptx = new PptxGenJS();
            
            // ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³è¨­å®š
            pptx.layout = 'LAYOUT_WIDE';
            pptx.title = 'AIãŒæ‹“ãæœªæ¥ï¼šç§ãŸã¡ã®ç”Ÿæ´»ã¨ç¤¾ä¼šã¯ã©ã†å¤‰ã‚ã‚‹ã‹ï¼Ÿ';
            pptx.author = 'AI Slide Generator';
            pptx.company = 'AI-Powered Presentation System';
            
            switch(type) {
                case 'future':
                    // ã‚¹ãƒ©ã‚¤ãƒ‰1: ã‚¿ã‚¤ãƒˆãƒ«ã‚¹ãƒ©ã‚¤ãƒ‰
                    let slide1 = pptx.addSlide();
                    slide1.background = { color: 'F5F7FA' };
                    
                    // èƒŒæ™¯ç”»åƒã®ä»£æ›¿ã¨ã—ã¦èƒŒæ™¯è‰²ä»˜ãã®å›³å½¢ã‚’è¿½åŠ 
                    slide1.addShape(pptx.ShapeType.rect, {
                        x: 0, y: 0, w: '100%', h: '100%',
                        fill: { 
                            type: 'gradient',
                            colors: [
                                { position: 0, color: '667eea' },
                                { position: 100, color: '764ba2' }
                            ],
                            angle: 135
                        }
                    });
                    
                    // åŠé€æ˜ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤
                    slide1.addShape(pptx.ShapeType.rect, {
                        x: 0, y: 0, w: '100%', h: '100%',
                        fill: { color: '000000', transparency: 60 }
                    });
                    
                    // ã‚¿ã‚¤ãƒˆãƒ«ãƒ†ã‚­ã‚¹ãƒˆ
                    slide1.addText('AIãŒæ‹“ãæœªæ¥ã¸ã‚ˆã†ã“ã', {
                        x: '5%', y: '35%', w: '90%', h: '15%',
                        fontSize: 48, bold: true, color: 'FFFFFF',
                        align: 'center', valign: 'middle'
                    });
                    
                    // ã‚µãƒ–ã‚¿ã‚¤ãƒˆãƒ«
                    slide1.addText('ãƒ†ã‚¯ãƒãƒ­ã‚¸ãƒ¼ãŒã‚‚ãŸã‚‰ã™å¤‰é©ã¨å¯èƒ½æ€§', {
                        x: '5%', y: '52%', w: '90%', h: '10%',
                        fontSize: 24, color: 'E0E0E0',
                        align: 'center', valign: 'middle'
                    });
                    
                    // ã‚¹ãƒ©ã‚¤ãƒ‰2: AIã®ç¾åœ¨åœ°
                    let slide2 = pptx.addSlide();
                    slide2.background = { color: 'F8F9FA' };
                    
                    // å·¦ã®è£…é£¾ç·š
                    slide2.addShape(pptx.ShapeType.rect, {
                        x: 0, y: 0, w: '3%', h: '100%',
                        fill: { color: '4285F4' }
                    });
                    
                    // ã‚¿ã‚¤ãƒˆãƒ«
                    slide2.addText('AIã®ç¾åœ¨åœ°', {
                        x: '8%', y: '15%', w: '84%', h: '18%',
                        fontSize: 64, bold: true, color: '0D47A1',
                        align: 'left', valign: 'middle'
                    });
                    
                    // ã‚µãƒ–ã‚¿ã‚¤ãƒˆãƒ«
                    slide2.addText('ç”ŸæˆAIãŒã‚‚ãŸã‚‰ã—ãŸé©å‘½', {
                        x: '8%', y: '34%', w: '84%', h: '10%',
                        fontSize: 28, color: '37474F',
                        align: 'left', valign: 'middle'
                    });
                    
                    // ç”»åƒã‚¨ãƒªã‚¢ã®ä»£æ›¿ã¨ã—ã¦èƒŒæ™¯ä»˜ããƒ†ã‚­ã‚¹ãƒˆãƒœãƒƒã‚¯ã‚¹
                    slide2.addShape(pptx.ShapeType.rect, {
                        x: '8%', y: '52%', w: '84%', h: '40%',
                        fill: { color: 'E3F2FD' }
                    });
                    
                    slide2.addText('ğŸ§ ', {
                        x: '8%', y: '60%', w: '84%', h: '15%',
                        fontSize: 80, align: 'center', valign: 'middle'
                    });
                    
                    slide2.addText('æŠ½è±¡çš„ãªäººå·¥çŸ¥èƒ½ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®ã‚¤ãƒ¡ãƒ¼ã‚¸', {
                        x: '8%', y: '78%', w: '84%', h: '8%',
                        fontSize: 18, color: '1565C0', align: 'center', valign: 'middle'
                    });
                    
                    // ã‚¹ãƒ©ã‚¤ãƒ‰3: ç¤¾ä¼šå®Ÿè£…ã®æœ€å‰ç·š
                    let slide3 = pptx.addSlide();
                    slide3.background = { color: 'F5F7FA' };
                    
                    // ã‚¿ã‚¤ãƒˆãƒ«
                    slide3.addText('ç¤¾ä¼šå®Ÿè£…ã®æœ€å‰ç·šï¼šAIã¯ã©ã“ã§æ´»èºã—ã¦ã„ã‚‹ã‹ï¼Ÿ', {
                        x: '5%', y: '5%', w: '90%', h: '15%',
                        fontSize: 36, bold: true, color: '1F2937',
                        align: 'center', valign: 'middle'
                    });
                    
                    // åŒ»ç™‚åˆ†é‡ã‚«ãƒ¼ãƒ‰
                    slide3.addShape(pptx.ShapeType.roundRect, {
                        x: '5%', y: '25%', w: '28%', h: '65%',
                        fill: { color: 'FFFFFF' },
                        line: { color: 'E5E7EB', width: 1 },
                        rectRadius: 0.2
                    });
                    
                    slide3.addText('ğŸ¥', {
                        x: '5%', y: '30%', w: '28%', h: '20%',
                        fontSize: 48, align: 'center', valign: 'middle'
                    });
                    
                    slide3.addText('åŒ»ç™‚åˆ†é‡', {
                        x: '5%', y: '53%', w: '28%', h: '10%',
                        fontSize: 18, bold: true, color: '374151',
                        align: 'center', valign: 'middle'
                    });
                    
                    slide3.addText('ç”»åƒè¨ºæ–­æ”¯æ´ã‚„å‰µè–¬ãƒ—ãƒ­ã‚»ã‚¹ã®é«˜é€ŸåŒ–ã«è²¢çŒ®ã—ã¾ã™ã€‚', {
                        x: '7%', y: '65%', w: '24%', h: '20%',
                        fontSize: 14, color: '4B5563',
                        align: 'center', valign: 'middle'
                    });
                    
                    // è‡ªå‹•é‹è»¢ã‚«ãƒ¼ãƒ‰
                    slide3.addShape(pptx.ShapeType.roundRect, {
                        x: '36%', y: '25%', w: '28%', h: '65%',
                        fill: { color: 'FFFFFF' },
                        line: { color: 'E5E7EB', width: 1 },
                        rectRadius: 0.2
                    });
                    
                    slide3.addText('ğŸš—', {
                        x: '36%', y: '30%', w: '28%', h: '20%',
                        fontSize: 48, align: 'center', valign: 'middle'
                    });
                    
                    slide3.addText('è‡ªå‹•é‹è»¢', {
                        x: '36%', y: '53%', w: '28%', h: '10%',
                        fontSize: 18, bold: true, color: '374151',
                        align: 'center', valign: 'middle'
                    });
                    
                    slide3.addText('å‘¨å›²ã®ç’°å¢ƒã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§èªè­˜ã—ã€å®‰å…¨ãªèµ°è¡Œã‚’å®Ÿç¾ã—ã¾ã™ã€‚', {
                        x: '38%', y: '65%', w: '24%', h: '20%',
                        fontSize: 14, color: '4B5563',
                        align: 'center', valign: 'middle'
                    });
                    
                    // é‡‘èãƒ»çµŒæ¸ˆã‚«ãƒ¼ãƒ‰
                    slide3.addShape(pptx.ShapeType.roundRect, {
                        x: '67%', y: '25%', w: '28%', h: '65%',
                        fill: { color: 'FFFFFF' },
                        line: { color: 'E5E7EB', width: 1 },
                        rectRadius: 0.2
                    });
                    
                    slide3.addText('ğŸ’°', {
                        x: '67%', y: '30%', w: '28%', h: '20%',
                        fontSize: 48, align: 'center', valign: 'middle'
                    });
                    
                    slide3.addText('é‡‘èãƒ»çµŒæ¸ˆ', {
                        x: '67%', y: '53%', w: '28%', h: '10%',
                        fontSize: 18, bold: true, color: '374151',
                        align: 'center', valign: 'middle'
                    });
                    
                    slide3.addText('å¸‚å ´äºˆæ¸¬ã‚„ä¸æ­£æ¤œçŸ¥ã€ãƒ‘ãƒ¼ã‚½ãƒŠãƒ©ã‚¤ã‚ºã•ã‚ŒãŸã‚¢ãƒ‰ãƒã‚¤ã‚¹ã‚’æä¾›ã—ã¾ã™ã€‚', {
                        x: '69%', y: '65%', w: '24%', h: '20%',
                        fontSize: 14, color: '4B5563',
                        align: 'center', valign: 'middle'
                    });
                    
                    // ã‚¹ãƒ©ã‚¤ãƒ‰4: 2030å¹´ã®AI
                    let slide4 = pptx.addSlide();
                    slide4.background = { color: 'F5F7FA' };
                    
                    // ã‚¿ã‚¤ãƒˆãƒ«
                    slide4.addText('2030å¹´ã®AIï¼šæœªæ¥äºˆæ¸¬ã¨å€«ç†çš„èª²é¡Œ', {
                        x: '5%', y: '25%', w: '90%', h: '18%',
                        fontSize: 48, bold: true, color: '1C3A5E',
                        align: 'center', valign: 'middle'
                    });
                    
                    // è£…é£¾ç·š
                    slide4.addShape(pptx.ShapeType.rect, {
                        x: '42.5%', y: '46%', w: '15%', h: '0.3%',
                        fill: { color: '4A90E2' }
                    });
                    
                    // ç”»åƒã‚¨ãƒªã‚¢ã®ä»£æ›¿
                    slide4.addShape(pptx.ShapeType.rect, {
                        x: '22.5%', y: '55%', w: '55%', h: '35%',
                        fill: { color: 'F0F4F8' }
                    });
                    
                    slide4.addText('ğŸ”®', {
                        x: '22.5%', y: '60%', w: '55%', h: '20%',
                        fontSize: 120, align: 'center', valign: 'middle'
                    });
                    
                    slide4.addText('æœªæ¥ã®ãƒ†ã‚¯ãƒãƒ­ã‚¸ãƒ¼ã¨äººå·¥çŸ¥èƒ½ã®æŠ½è±¡çš„ãªè¡¨ç¾', {
                        x: '22.5%', y: '82%', w: '55%', h: '8%',
                        fontSize: 18, color: '1565C0',
                        align: 'center', valign: 'middle'
                    });
                    
                    // ã‚¹ãƒ©ã‚¤ãƒ‰5: ã¾ã¨ã‚
                    let slide5 = pptx.addSlide();
                    slide5.background = { color: 'F8FAFC' };
                    
                    // ã‚¿ã‚¤ãƒˆãƒ«
                    slide5.addText('ã¾ã¨ã‚ï¼šAIã¨å…±å­˜ã™ã‚‹æœªæ¥ã‚’ã©ã†å‰µã‚‹ã‹', {
                        x: '7%', y: '10%', w: '86%', h: '12%',
                        fontSize: 36, bold: true, color: '0F172A',
                        align: 'left', valign: 'middle'
                    });
                    
                    // è£…é£¾ç·š
                    slide5.addShape(pptx.ShapeType.rect, {
                        x: '7%', y: '24%', w: '40%', h: '0.5%',
                        fill: { color: '3B82F6' }
                    });
                    
                    // ç®‡æ¡æ›¸ã
                    slide5.addText([
                        { text: 'ç¶™ç¶šçš„ãªå­¦ç¿’ã¨é©å¿œ', options: { bullet: true } },
                        { text: 'å€«ç†çš„æŒ‡é‡ã®ç¢ºç«‹ã¨å®Ÿè·µ', options: { bullet: true } },
                        { text: 'äººé–“ã¨AIã®å”åƒã«ã‚ˆã‚‹ä¾¡å€¤å‰µé€ ', options: { bullet: true } }
                    ], {
                        x: '7%', y: '32%', w: '45%', h: '50%',
                        fontSize: 22, color: '334155',
                        lineSpacing: 36
                    });
                    
                    // å³å´ã®ç”»åƒã‚¨ãƒªã‚¢
                    slide5.addText('ğŸ¤', {
                        x: '58%', y: '40%', w: '35%', h: '30%',
                        fontSize: 150, align: 'center', valign: 'middle'
                    });
                    
                    slide5.addText('äººå·¥çŸ¥èƒ½ã¨äººé–“ã®å”åŠ›ã‚’è±¡å¾´ã™ã‚‹ã‚¤ãƒ¡ãƒ¼ã‚¸', {
                        x: '58%', y: '75%', w: '35%', h: '8%',
                        fontSize: 16, color: '6B7280',
                        align: 'center', valign: 'middle'
                    });
                    
                    break;
                    
                case 'innovation':
                    // æŠ€è¡“é©æ–°ç‰ˆ - ã‚ˆã‚Šç°¡ç´ åŒ–
                    let innSlide1 = pptx.addSlide();
                    innSlide1.addShape(pptx.ShapeType.rect, {
                        x: 0, y: 0, w: '100%', h: '100%',
                        fill: { 
                            type: 'gradient',
                            colors: [
                                { position: 0, color: '11998e' },
                                { position: 100, color: '38ef7d' }
                            ],
                            angle: 135
                        }
                    });
                    
                    innSlide1.addText('æŠ€è¡“é©æ–°ã¨ç¤¾ä¼šå¤‰é©', {
                        x: '5%', y: '35%', w: '90%', h: '15%',
                        fontSize: 48, bold: true, color: 'FFFFFF',
                        align: 'center', valign: 'middle'
                    });
                    
                    innSlide1.addText('AIãŒåˆ‡ã‚Šæ‹“ãæ–°ãŸãªå¯èƒ½æ€§', {
                        x: '5%', y: '52%', w: '90%', h: '10%',
                        fontSize: 24, color: 'FFFFFF',
                        align: 'center', valign: 'middle'
                    });
                    
                    break;
            }
            
            pptx.writeFile({ fileName: `AI-${type}-presentation.pptx` });
        }
        
        // ã‚³ãƒ¼ãƒ‰è¡¨ç¤ºé–¢æ•°
        function showCode(code) {
            document.getElementById('codePreview').innerHTML = `<pre>${code}</pre>`;
        }

        // =========================
        // JSONãƒ™ãƒ¼ã‚¹PPTXç”Ÿæˆæ©Ÿèƒ½
        // =========================
        
        // JSONæ¤œè¨¼æ©Ÿèƒ½
        function validateJSON() {
            const jsonText = document.getElementById('jsonInput').value;
            const resultDiv = document.getElementById('jsonValidationResult');
            
            try {
                const data = JSON.parse(jsonText);
                
                // åŸºæœ¬æ§‹é€ ã®æ¤œè¨¼
                const requiredFields = ['title', 'slides'];
                const missingFields = requiredFields.filter(field => !data[field]);
                
                if (missingFields.length > 0) {
                    showValidationResult('danger', `å¿…é ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒä¸è¶³ã—ã¦ã„ã¾ã™: ${missingFields.join(', ')}`);
                    return false;
                }
                
                // ã‚¹ãƒ©ã‚¤ãƒ‰æ§‹é€ ã®æ¤œè¨¼
                if (!Array.isArray(data.slides) || data.slides.length === 0) {
                    showValidationResult('danger', 'slidesã¯ç©ºã§ãªã„é…åˆ—ã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™');
                    return false;
                }
                
                // å„ã‚¹ãƒ©ã‚¤ãƒ‰ã®æ¤œè¨¼
                for (let i = 0; i < data.slides.length; i++) {
                    const slide = data.slides[i];
                    if (!slide.elements || !Array.isArray(slide.elements)) {
                        showValidationResult('warning', `ã‚¹ãƒ©ã‚¤ãƒ‰${i + 1}: elementsãŒé…åˆ—ã§ã¯ã‚ã‚Šã¾ã›ã‚“`);
                    }
                }
                
                showValidationResult('success', `âœ… JSONæ§‹é€ ã¯æœ‰åŠ¹ã§ã™ (${data.slides.length}ã‚¹ãƒ©ã‚¤ãƒ‰)`);
                return true;
                
            } catch (error) {
                showValidationResult('danger', `âŒ JSONæ§‹æ–‡ã‚¨ãƒ©ãƒ¼: ${error.message}`);
                return false;
            }
        }
        
        // æ¤œè¨¼çµæœã®è¡¨ç¤º
        function showValidationResult(type, message) {
            const resultDiv = document.getElementById('jsonValidationResult');
            resultDiv.className = `alert alert-${type}`;
            resultDiv.textContent = message;
            resultDiv.style.display = 'block';
            
            // 5ç§’å¾Œã«éè¡¨ç¤º
            setTimeout(() => {
                resultDiv.style.display = 'none';
            }, 5000);
        }
        
        // ã‚µãƒ³ãƒ—ãƒ«JSONèª­ã¿è¾¼ã¿
        function loadSampleJSON() {
            const sampleJSON = {
                "title": "AIãƒ»æ©Ÿæ¢°å­¦ç¿’ã®æœ€æ–°å‹•å‘",
                "author": "Tech Innovation Team",
                "company": "Future Tech Solutions",
                "layout": "LAYOUT_16x9",
                "slides": [
                    {
                        "slideIndex": 0,
                        "topic": "AIé©å‘½ã®å§‹ã¾ã‚Š",
                        "background": {
                            "type": "gradient",
                            "colors": ["667eea", "764ba2"],
                            "angle": 135
                        },
                        "elements": [
                            {
                                "type": "shape",
                                "shapeType": "rect",
                                "options": {"x": 0, "y": 0, "w": 100, "h": 100},
                                "style": {
                                    "fill": {"color": "000000", "transparency": 40}
                                }
                            },
                            {
                                "type": "text",
                                "textType": "title",
                                "content": "AIé©å‘½ã®å§‹ã¾ã‚Š",
                                "options": {"x": 5, "y": 35, "w": 90, "h": 15},
                                "style": {
                                    "fontSize": 48,
                                    "bold": true,
                                    "color": "FFFFFF",
                                    "align": "center"
                                }
                            },
                            {
                                "type": "text", 
                                "textType": "subtitle",
                                "content": "æ©Ÿæ¢°å­¦ç¿’ãƒ»æ·±å±¤å­¦ç¿’ã®æœ€æ–°æŠ€è¡“å‹•å‘",
                                "options": {"x": 5, "y": 52, "w": 90, "h": 10},
                                "style": {
                                    "fontSize": 24,
                                    "color": "E0E0E0",
                                    "align": "center"
                                }
                            }
                        ]
                    },
                    {
                        "slideIndex": 1,
                        "topic": "AIæŠ€è¡“ã®ç¾çŠ¶åˆ†æ",
                        "background": "#F8F9FA",
                        "elements": [
                            {
                                "type": "text",
                                "textType": "title", 
                                "content": "AIæŠ€è¡“ã®ç¾çŠ¶åˆ†æ",
                                "options": {"x": 5, "y": 8, "w": 90, "h": 12},
                                "style": {
                                    "fontSize": 42,
                                    "bold": true,
                                    "color": "1F2937",
                                    "align": "center"
                                }
                            },
                            {
                                "type": "chart",
                                "chartType": "bar",
                                "data": [
                                    {
                                        "name": "AIå°å…¥ç‡",
                                        "labels": ["è‡ªç„¶è¨€èªå‡¦ç†", "ç”»åƒèªè­˜", "éŸ³å£°èªè­˜", "äºˆæ¸¬åˆ†æ", "è‡ªå‹•åŒ–"],
                                        "values": [92, 87, 78, 85, 74]
                                    }
                                ],
                                "options": {"x": 10, "y": 25, "w": 80, "h": 60},
                                "chartOptions": {
                                    "title": "AIæŠ€è¡“é ˜åŸŸåˆ¥æ™®åŠç‡ï¼ˆ%ï¼‰",
                                    "showValue": true,
                                    "showLegend": false,
                                    "chartColors": ["4285F4", "34A853", "FBBC04", "EA4335", "9C27B0"]
                                }
                            }
                        ]
                    },
                    {
                        "slideIndex": 2,
                        "topic": "ç”£æ¥­åˆ¥AIå°å…¥åŠ¹æœ",
                        "background": "#FFFFFF",
                        "elements": [
                            {
                                "type": "text",
                                "textType": "title",
                                "content": "ç”£æ¥­åˆ¥AIå°å…¥åŠ¹æœã®æ¯”è¼ƒ",
                                "options": {"x": 5, "y": 5, "w": 90, "h": 15},
                                "style": {
                                    "fontSize": 36,
                                    "bold": true,
                                    "color": "1F2937",
                                    "align": "center"
                                }
                            },
                            {
                                "type": "table",
                                "data": [
                                    [
                                        {"text": "ç”£æ¥­åˆ†é‡", "options": {"fill": "4285F4", "color": "FFFFFF", "bold": true}},
                                        {"text": "å°å…¥ç‡", "options": {"fill": "4285F4", "color": "FFFFFF", "bold": true}},
                                        {"text": "åŠ¹æœå®Ÿæ„Ÿ", "options": {"fill": "4285F4", "color": "FFFFFF", "bold": true}},
                                        {"text": "ROI", "options": {"fill": "4285F4", "color": "FFFFFF", "bold": true}},
                                        {"text": "è©•ä¾¡", "options": {"fill": "4285F4", "color": "FFFFFF", "bold": true}}
                                    ],
                                    ["é‡‘èãƒ»ä¿é™º", "89%", "95%", "320%", "â˜…â˜…â˜…â˜…â˜…"],
                                    ["è£½é€ æ¥­", "76%", "88%", "280%", "â˜…â˜…â˜…â˜…â˜†"], 
                                    ["ãƒ˜ãƒ«ã‚¹ã‚±ã‚¢", "82%", "92%", "350%", "â˜…â˜…â˜…â˜…â˜…"],
                                    ["å°å£²ãƒ»EC", "71%", "84%", "240%", "â˜…â˜…â˜…â˜†â˜†"],
                                    ["ç‰©æµãƒ»é‹è¼¸", "68%", "81%", "220%", "â˜…â˜…â˜…â˜†â˜†"],
                                    ["ã‚¨ãƒãƒ«ã‚®ãƒ¼", "74%", "87%", "300%", "â˜…â˜…â˜…â˜…â˜†"]
                                ],
                                "options": {"x": 5, "y": 25, "w": 90, "h": 65},
                                "tableOptions": {
                                    "border": {"type": "solid", "pt": 1, "color": "CCCCCC"},
                                    "fontSize": 14,
                                    "align": "center"
                                }
                            }
                        ]
                    },
                    {
                        "slideIndex": 3,
                        "topic": "é«˜åº¦ãªå›³å½¢ã¨ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«",
                        "background": "#F5F7FA",
                        "elements": [
                            {
                                "type": "text",
                                "textType": "title",
                                "content": "AIæŠ€è¡“ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£",
                                "options": {"x": 5, "y": 5, "w": 90, "h": 12},
                                "style": {
                                    "fontSize": 36,
                                    "bold": true,
                                    "color": "1F2937",
                                    "align": "center"
                                }
                            },
                            {
                                "type": "shape",
                                "shapeType": "roundRect",
                                "options": {"x": 10, "y": 25, "w": 25, "h": 15},
                                "style": {
                                    "fill": {"color": "4285F4"},
                                    "line": {"color": "2563EB", "width": 2},
                                    "rectRadius": 0.3
                                }
                            },
                            {
                                "type": "text",
                                "content": "ãƒ‡ãƒ¼ã‚¿åé›†",
                                "options": {"x": 10, "y": 25, "w": 25, "h": 15},
                                "style": {
                                    "fontSize": 16,
                                    "bold": true,
                                    "color": "FFFFFF",
                                    "align": "center",
                                    "valign": "middle"
                                }
                            },
                            {
                                "type": "shape",
                                "shapeType": "roundRect", 
                                "options": {"x": 40, "y": 25, "w": 25, "h": 15},
                                "style": {
                                    "fill": {"color": "34A853"},
                                    "line": {"color": "16A249", "width": 2},
                                    "rectRadius": 0.3
                                }
                            },
                            {
                                "type": "text",
                                "content": "æ©Ÿæ¢°å­¦ç¿’",
                                "options": {"x": 40, "y": 25, "w": 25, "h": 15},
                                "style": {
                                    "fontSize": 16,
                                    "bold": true,
                                    "color": "FFFFFF",
                                    "align": "center",
                                    "valign": "middle"
                                }
                            },
                            {
                                "type": "shape",
                                "shapeType": "roundRect",
                                "options": {"x": 70, "y": 25, "w": 25, "h": 15},
                                "style": {
                                    "fill": {"color": "EA4335"},
                                    "line": {"color": "DC2626", "width": 2},
                                    "rectRadius": 0.3
                                }
                            },
                            {
                                "type": "text",
                                "content": "äºˆæ¸¬ãƒ»åˆ¤æ–­",
                                "options": {"x": 70, "y": 25, "w": 25, "h": 15},
                                "style": {
                                    "fontSize": 16,
                                    "bold": true,
                                    "color": "FFFFFF",
                                    "align": "center",
                                    "valign": "middle"
                                }
                            },
                            {
                                "type": "shape",
                                "shapeType": "rightArrow",
                                "options": {"x": 36, "y": 31, "w": 3, "h": 3},
                                "style": {
                                    "fill": {"color": "6B7280"}
                                }
                            },
                            {
                                "type": "shape",
                                "shapeType": "rightArrow",
                                "options": {"x": 66, "y": 31, "w": 3, "h": 3},
                                "style": {
                                    "fill": {"color": "6B7280"}
                                }
                            }
                        ]
                    },
                    {
                        "slideIndex": 4,
                        "topic": "ä»Šå¾Œã®å±•æœ›ã¨èª²é¡Œ",
                        "background": "#F8FAFC",
                        "elements": [
                            {
                                "type": "text",
                                "textType": "title",
                                "content": "AIæŠ€è¡“ã®ä»Šå¾Œã®å±•æœ›ã¨èª²é¡Œ",
                                "options": {"x": 5, "y": 8, "w": 90, "h": 12},
                                "style": {
                                    "fontSize": 36,
                                    "bold": true,
                                    "color": "0F172A",
                                    "align": "center"
                                }
                            },
                            {
                                "type": "shape",
                                "shapeType": "rect",
                                "options": {"x": 8, "y": 25, "w": 40, "h": 65},
                                "style": {
                                    "fill": {"color": "E0F2FE"},
                                    "line": {"color": "0EA5E9", "width": 2}
                                }
                            },
                            {
                                "type": "text",
                                "textType": "subtitle",
                                "content": "æ©Ÿä¼šãƒ»å±•æœ›",
                                "options": {"x": 10, "y": 28, "w": 36, "h": 8},
                                "style": {
                                    "fontSize": 20,
                                    "bold": true,
                                    "color": "0C4A6E",
                                    "align": "center"
                                }
                            },
                            {
                                "type": "text",
                                "content": "â€¢ AGIï¼ˆæ±ç”¨äººå·¥çŸ¥èƒ½ï¼‰ã®å®Ÿç¾\nâ€¢ é‡å­ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°é€£æº\nâ€¢ è‡ªå¾‹ã‚·ã‚¹ãƒ†ãƒ ã®é«˜åº¦åŒ–\nâ€¢ å‰µè–¬ãƒ»ææ–™ç§‘å­¦ã§ã®é©æ–°\nâ€¢ ã‚«ãƒ¼ãƒœãƒ³ãƒ‹ãƒ¥ãƒ¼ãƒˆãƒ©ãƒ«æ”¯æ´",
                                "options": {"x": 10, "y": 38, "w": 36, "h": 45},
                                "style": {
                                    "fontSize": 14,
                                    "color": "1F2937",
                                    "lineSpacing": 24
                                }
                            },
                            {
                                "type": "shape",
                                "shapeType": "rect",
                                "options": {"x": 52, "y": 25, "w": 40, "h": 65},
                                "style": {
                                    "fill": {"color": "FEF3C7"},
                                    "line": {"color": "F59E0B", "width": 2}
                                }
                            },
                            {
                                "type": "text",
                                "textType": "subtitle",
                                "content": "èª²é¡Œãƒ»ãƒªã‚¹ã‚¯",
                                "options": {"x": 54, "y": 28, "w": 36, "h": 8},
                                "style": {
                                    "fontSize": 20,
                                    "bold": true,
                                    "color": "92400E",
                                    "align": "center"
                                }
                            },
                            {
                                "type": "text",
                                "content": "â€¢ ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒ»ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£\nâ€¢ ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ãƒã‚¤ã‚¢ã‚¹\nâ€¢ é›‡ç”¨ã¸ã®å½±éŸ¿\nâ€¢ ã‚¨ãƒãƒ«ã‚®ãƒ¼æ¶ˆè²»å•é¡Œ\nâ€¢ è¦åˆ¶ãƒ»ã‚¬ãƒãƒŠãƒ³ã‚¹æ•´å‚™",
                                "options": {"x": 54, "y": 38, "w": 36, "h": 45},
                                "style": {
                                    "fontSize": 14,
                                    "color": "1F2937",
                                    "lineSpacing": 24
                                }
                            }
                        ]
                    }
                ]
            };
            
            document.getElementById('jsonInput').value = JSON.stringify(sampleJSON, null, 2);
            showValidationResult('info', 'ğŸ“„ ã‚µãƒ³ãƒ—ãƒ«JSONã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ');
        }
        
        // JSONã‹ã‚‰ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”Ÿæˆ
        function previewFromJSON() {
            if (!validateJSON()) return;
            
            try {
                const jsonData = JSON.parse(document.getElementById('jsonInput').value);
                currentType = 'json';
                currentSubType = 'custom';
                currentSlides = [];
                
                // å„ã‚¹ãƒ©ã‚¤ãƒ‰ã‚’ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”¨ã«å¤‰æ›
                jsonData.slides.forEach((slideData, index) => {
                    let slideHTML = '';
                    
                    // èƒŒæ™¯ã®é©ç”¨
                    let backgroundStyle = '';
                    if (slideData.background) {
                        if (typeof slideData.background === 'string') {
                            backgroundStyle = `background-color: ${slideData.background};`;
                        } else if (slideData.background.type === 'gradient') {
                            const colors = slideData.background.colors.map(c => `#${c}`).join(', ');
                            backgroundStyle = `background: linear-gradient(${slideData.background.angle || 135}deg, ${colors});`;
                        }
                    }
                    
                    slideHTML = `<div style="${backgroundStyle} width: 100%; height: 100%; position: relative; padding: 20px;">`;
                    
                    // å„è¦ç´ ã‚’å‡¦ç†
                    slideData.elements.forEach(element => {
                        const opts = element.options || {};
                        const style = element.style || {};
                        
                        switch (element.type) {
                            case 'text':
                                const fontSize = style.fontSize || 16;
                                const color = style.color ? `#${style.color}` : '#000000';
                                const fontWeight = style.bold ? 'bold' : 'normal';
                                const textAlign = style.align || 'left';
                                
                                slideHTML += `
                                    <div style="
                                        position: absolute;
                                        left: ${opts.x || 0}%;
                                        top: ${opts.y || 0}%;
                                        width: ${opts.w || 50}%;
                                        height: ${opts.h || 10}%;
                                        font-size: ${fontSize}px;
                                        color: ${color};
                                        font-weight: ${fontWeight};
                                        text-align: ${textAlign};
                                        display: flex;
                                        align-items: center;
                                        ${textAlign === 'center' ? 'justify-content: center;' : ''}
                                    ">
                                        ${element.content}
                                    </div>
                                `;
                                break;
                                
                            case 'chart':
                                slideHTML += `
                                    <div style="
                                        position: absolute;
                                        left: ${opts.x || 10}%;
                                        top: ${opts.y || 20}%;
                                        width: ${opts.w || 80}%;
                                        height: ${opts.h || 60}%;
                                        background: white;
                                        border: 1px solid #ddd;
                                        border-radius: 5px;
                                        display: flex;
                                        align-items: center;
                                        justify-content: center;
                                        flex-direction: column;
                                    ">
                                        <canvas id="chart_${index}_${Math.random().toString(36).substr(2, 9)}" width="400" height="300"></canvas>
                                        <p style="margin-top: 10px; color: #666; font-size: 14px;">${element.chartOptions?.title || 'ãƒãƒ£ãƒ¼ãƒˆ'}</p>
                                    </div>
                                `;
                                break;
                                
                            case 'table':
                                let tableHTML = '<table style="width: 100%; border-collapse: collapse;">';
                                element.data.forEach((row, rowIndex) => {
                                    tableHTML += '<tr>';
                                    row.forEach(cell => {
                                        const cellData = typeof cell === 'string' ? { text: cell, options: {} } : cell;
                                        const cellStyle = cellData.options || {};
                                        const bgColor = cellStyle.fill ? `#${cellStyle.fill}` : '';
                                        const textColor = cellStyle.color ? `#${cellStyle.color}` : '';
                                        const isHeader = rowIndex === 0;
                                        
                                        tableHTML += `
                                            <${isHeader ? 'th' : 'td'} style="
                                                border: 1px solid #ccc;
                                                padding: 8px;
                                                background-color: ${bgColor};
                                                color: ${textColor};
                                                font-weight: ${cellStyle.bold ? 'bold' : 'normal'};
                                                text-align: center;
                                            ">
                                                ${cellData.text}
                                            </${isHeader ? 'th' : 'td'}>
                                        `;
                                    });
                                    tableHTML += '</tr>';
                                });
                                tableHTML += '</table>';
                                
                                slideHTML += `
                                    <div style="
                                        position: absolute;
                                        left: ${opts.x || 10}%;
                                        top: ${opts.y || 20}%;
                                        width: ${opts.w || 80}%;
                                        height: ${opts.h || 60}%;
                                        overflow: auto;
                                    ">
                                        ${tableHTML}
                                    </div>
                                `;
                                break;
                                
                            case 'shape':
                                const shapeStyle = element.style || {};
                                const fillColor = shapeStyle.fill?.color ? `#${shapeStyle.fill.color}` : '#cccccc';
                                const borderColor = shapeStyle.line?.color ? `#${shapeStyle.line.color}` : '#000000';
                                const borderWidth = shapeStyle.line?.width || 1;
                                const borderRadius = element.shapeType === 'roundRect' ? '10px' : '0';
                                
                                slideHTML += `
                                    <div style="
                                        position: absolute;
                                        left: ${opts.x || 10}%;
                                        top: ${opts.y || 20}%;
                                        width: ${opts.w || 20}%;
                                        height: ${opts.h || 15}%;
                                        background-color: ${fillColor};
                                        border: ${borderWidth}px solid ${borderColor};
                                        border-radius: ${borderRadius};
                                    ">
                                    </div>
                                `;
                                break;
                        }
                    });
                    
                    slideHTML += '</div>';
                    
                    currentSlides.push({
                        title: slideData.topic || `ã‚¹ãƒ©ã‚¤ãƒ‰ ${index + 1}`,
                        content: slideHTML
                    });
                });
                
                currentSlideIndex = 0;
                updateSlide();
                showPreviewModal(`JSONãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ - ${jsonData.title}`);
                
            } catch (error) {
                showValidationResult('danger', `ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”Ÿæˆã‚¨ãƒ©ãƒ¼: ${error.message}`);
            }
        }
        
        // JSONã‹ã‚‰PPTXç”Ÿæˆ
        function generateFromJSON() {
            if (!validateJSON()) return;
            
            try {
                const jsonData = JSON.parse(document.getElementById('jsonInput').value);
                let pptx = new PptxGenJS();
                
                // ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³è¨­å®š
                if (jsonData.layout) pptx.layout = jsonData.layout;
                if (jsonData.title) pptx.title = jsonData.title;
                if (jsonData.author) pptx.author = jsonData.author;
                if (jsonData.company) pptx.company = jsonData.company;
                
                // å„ã‚¹ãƒ©ã‚¤ãƒ‰ã‚’ç”Ÿæˆ
                jsonData.slides.forEach(slideData => {
                    let slide = pptx.addSlide();
                    
                    // èƒŒæ™¯è¨­å®š
                    if (slideData.background) {
                        if (typeof slideData.background === 'string') {
                            slide.background = { color: slideData.background.replace('#', '') };
                        } else if (slideData.background.type === 'gradient') {
                            // ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³èƒŒæ™¯ï¼ˆå›³å½¢ã§ä»£æ›¿ï¼‰
                            slide.addShape(pptx.ShapeType.rect, {
                                x: 0, y: 0, w: '100%', h: '100%',
                                fill: { color: slideData.background.colors[0] }
                            });
                        }
                    }
                    
                    // å„è¦ç´ ã‚’è¿½åŠ 
                    slideData.elements.forEach(element => {
                        const opts = element.options || {};
                        const style = element.style || {};
                        
                        // åº§æ¨™ã®æ­£è¦åŒ–ï¼ˆ%ã‚’0-100ã®ã‚¹ã‚±ãƒ¼ãƒ«ã§å‡¦ç†ï¼‰
                        const normalizeCoord = (value, isPercentage = false) => {
                            if (typeof value === 'string' && value.includes('%')) {
                                return parseFloat(value) / 100 * (isPercentage ? 100 : 10);
                            }
                            return typeof value === 'number' ? value / 10 : value;
                        };
                        
                        const position = {
                            x: normalizeCoord(opts.x),
                            y: normalizeCoord(opts.y),
                            w: normalizeCoord(opts.w),
                            h: normalizeCoord(opts.h)
                        };
                        
                        switch (element.type) {
                            case 'text':
                                const textOptions = {
                                    ...position,
                                    fontSize: style.fontSize || 16,
                                    color: style.color || '000000',
                                    bold: style.bold || false,
                                    align: style.align || 'left',
                                    valign: style.valign || 'top'
                                };
                                
                                slide.addText(element.content, textOptions);
                                break;
                                
                            case 'chart':
                                const chartData = element.data || [];
                                const chartOptions = {
                                    ...position,
                                    title: element.chartOptions?.title || '',
                                    showValue: element.chartOptions?.showValue || false,
                                    showLegend: element.chartOptions?.showLegend !== false,
                                    chartColors: element.chartOptions?.chartColors || ['4285F4', '34A853', 'FBBC04', 'EA4335']
                                };
                                
                                if (chartData.length > 0) {
                                    slide.addChart(element.chartType || 'bar', chartData, chartOptions);
                                }
                                break;
                                
                            case 'table':
                                const tableOptions = {
                                    ...position,
                                    border: element.tableOptions?.border || { type: 'solid', pt: 1, color: 'CCCCCC' },
                                    fontSize: element.tableOptions?.fontSize || 12,
                                    align: element.tableOptions?.align || 'center'
                                };
                                
                                slide.addTable(element.data || [], tableOptions);
                                break;
                                
                            case 'shape':
                                const shapeType = element.shapeType || 'rect';
                                const shapeOptions = {
                                    ...position,
                                    fill: element.style?.fill || { color: 'CCCCCC' },
                                    line: element.style?.line || { color: '000000', width: 1 }
                                };
                                
                                if (element.style?.rectRadius) {
                                    shapeOptions.rectRadius = element.style.rectRadius;
                                }
                                
                                slide.addShape(pptx.ShapeType[shapeType] || pptx.ShapeType.rect, shapeOptions);
                                break;
                                
                            case 'image':
                                const imageOptions = {
                                    ...position,
                                    path: element.path,
                                    data: element.data,
                                    sizing: element.sizing,
                                    transparency: element.transparency || 0,
                                    rotate: element.rotate || 0,
                                    flipH: element.flipH || false,
                                    flipV: element.flipV || false
                                };
                                
                                if (element.path || element.data) {
                                    slide.addImage(imageOptions);
                                }
                                break;
                        }
                    });
                });
                
                const fileName = `${jsonData.title || 'JSON-Generated-Presentation'}.pptx`;
                pptx.writeFile({ fileName: fileName });
                
                showValidationResult('success', `âœ… PPTXç”Ÿæˆå®Œäº†: ${fileName}`);
                
            } catch (error) {
                showValidationResult('danger', `PPTXç”Ÿæˆã‚¨ãƒ©ãƒ¼: ${error.message}`);
            }
        }
        
        // é«˜åº¦ãªæ©Ÿèƒ½ã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ»ç”Ÿæˆ
        function previewAdvanced(type) {
            currentType = 'advanced';
            currentSubType = type;
            currentSlides = [];
            
            switch(type) {
                case 'shapes':
                    currentSlides.push({
                        title: 'é«˜åº¦ãªå›³å½¢æ©Ÿèƒ½',
                        content: `
                            <div style="padding: 20px;">
                                <h2 class="mb-4">é«˜åº¦ãªå›³å½¢æ©Ÿèƒ½</h2>
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; height: 300px;">
                                    <div style="text-align: center;">
                                        <h4>ã‚«ã‚¹ã‚¿ãƒ ã‚¸ã‚ªãƒ¡ãƒˆãƒª</h4>
                                        <svg width="200" height="150" style="border: 1px solid #ddd;">
                                            <path d="M 50 50 L 150 50 Q 180 50 180 80 L 180 120 Q 180 150 150 150 L 50 150 Q 20 150 20 120 L 20 80 Q 20 50 50 50 Z" 
                                                  fill="#4285F4" stroke="#1565C0" stroke-width="2"/>
                                            <circle cx="100" cy="100" r="20" fill="#34A853" opacity="0.8"/>
                                        </svg>
                                    </div>
                                    <div style="text-align: center;">
                                        <h4>å½±åŠ¹æœãƒ»ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³</h4>
                                        <div style="
                                            width: 120px; height: 80px; margin: 20px auto;
                                            background: linear-gradient(45deg, #667eea, #764ba2);
                                            border-radius: 10px;
                                            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);
                                            display: flex; align-items: center; justify-content: center;
                                            color: white; font-weight: bold;
                                        ">
                                            ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
                                        </div>
                                    </div>
                                </div>
                            </div>
                        `
                    });
                    break;
                    
                case 'images':
                    currentSlides.push({
                        title: 'ç”»åƒå‡¦ç†æ©Ÿèƒ½',
                        content: `
                            <div style="padding: 20px;">
                                <h2 class="mb-4">ç”»åƒå‡¦ç†æ©Ÿèƒ½</h2>
                                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px;">
                                    <div style="text-align: center;">
                                        <h5>ãƒªã‚µã‚¤ã‚ºãƒ»ã‚¯ãƒ­ãƒƒãƒ”ãƒ³ã‚°</h5>
                                        <div style="width: 100px; height: 60px; margin: 10px auto; background: #f0f0f0; border: 2px dashed #ccc; display: flex; align-items: center; justify-content: center; font-size: 12px;">
                                            CROP
                                        </div>
                                    </div>
                                    <div style="text-align: center;">
                                        <h5>é€æ˜åº¦ãƒ»å›è»¢</h5>
                                        <div style="width: 80px; height: 80px; margin: 10px auto; background: #4285F4; opacity: 0.5; transform: rotate(25deg); border-radius: 50%;"></div>
                                    </div>
                                    <div style="text-align: center;">
                                        <h5>SVGã‚µãƒãƒ¼ãƒˆ</h5>
                                        <svg width="80" height="80" style="margin: 10px auto;">
                                            <polygon points="40,5 75,35 60,70 20,70 5,35" fill="#34A853"/>
                                            <text x="40" y="45" text-anchor="middle" fill="white" font-size="12">SVG</text>
                                        </svg>
                                    </div>
                                </div>
                            </div>
                        `
                    });
                    break;
                    
                case 'charts':
                    currentSlides.push({
                        title: 'é«˜åº¦ãªãƒãƒ£ãƒ¼ãƒˆæ©Ÿèƒ½',
                        content: `
                            <div style="padding: 20px;">
                                <h2 class="mb-4">é«˜åº¦ãªãƒãƒ£ãƒ¼ãƒˆæ©Ÿèƒ½</h2>
                                <div style="display: flex; justify-content: space-around; height: 250px; align-items: center;">
                                    <div style="text-align: center;">
                                        <h5>3Dãƒãƒ£ãƒ¼ãƒˆ</h5>
                                        <canvas id="advanced3DChart" width="150" height="150"></canvas>
                                    </div>
                                    <div style="text-align: center;">
                                        <h5>ãƒãƒ«ãƒã‚·ãƒªãƒ¼ã‚º</h5>
                                        <canvas id="advancedMultiChart" width="150" height="150"></canvas>
                                    </div>
                                </div>
                            </div>
                        `,
                        init: () => {
                            // 3Dãƒãƒ£ãƒ¼ãƒˆã®ã‚µãƒ³ãƒ—ãƒ«
                            const ctx3D = document.getElementById('advanced3DChart')?.getContext('2d');
                            if (ctx3D) {
                                new Chart(ctx3D, {
                                    type: 'bar',
                                    data: {
                                        labels: ['A', 'B', 'C'],
                                        datasets: [{
                                            data: [10, 20, 15],
                                            backgroundColor: ['#4285F4', '#34A853', '#FBBC04']
                                        }]
                                    },
                                    options: { responsive: false, plugins: { legend: { display: false } } }
                                });
                            }
                            
                            // ãƒãƒ«ãƒã‚·ãƒªãƒ¼ã‚ºãƒãƒ£ãƒ¼ãƒˆ
                            const ctxMulti = document.getElementById('advancedMultiChart')?.getContext('2d');
                            if (ctxMulti) {
                                new Chart(ctxMulti, {
                                    type: 'line',
                                    data: {
                                        labels: ['Jan', 'Feb', 'Mar'],
                                        datasets: [
                                            { label: 'Series 1', data: [10, 15, 12], borderColor: '#4285F4', fill: false },
                                            { label: 'Series 2', data: [8, 12, 18], borderColor: '#34A853', fill: false }
                                        ]
                                    },
                                    options: { responsive: false }
                                });
                            }
                        }
                    });
                    break;
            }
            
            currentSlideIndex = 0;
            updateSlide();
            showPreviewModal(`é«˜åº¦ãªæ©Ÿèƒ½ - ${type}`);
        }
        
        function generateAdvanced(type) {
            let pptx = new PptxGenJS();
            let slide = pptx.addSlide();
            
            switch(type) {
                case 'shapes':
                    // ã‚¿ã‚¤ãƒˆãƒ«
                    slide.addText('é«˜åº¦ãªå›³å½¢æ©Ÿèƒ½ãƒ‡ãƒ¢', { x: 1, y: 0.5, w: 8, h: 1, fontSize: 24, bold: true });
                    
                    // ã‚«ã‚¹ã‚¿ãƒ ã‚¸ã‚ªãƒ¡ãƒˆãƒª
                    slide.addShape(pptx.ShapeType.custGeom, {
                        x: 1, y: 2, w: 3, h: 2,
                        points: [
                            { x: 0, y: 0.5 },
                            { x: 0.5, y: 0, curve: { type: 'quadratic', x1: 0.3, y1: 0.2 } },
                            { x: 1, y: 0.5 },
                            { x: 0.5, y: 1, curve: { type: 'quadratic', x1: 0.7, y1: 0.8 } },
                            { close: true }
                        ],
                        fill: { color: '4285F4' },
                        shadow: { type: 'outer', blur: 10, offset: 5, angle: 45, color: '000000', opacity: 0.3 }
                    });
                    
                    // ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³å›³å½¢
                    slide.addShape(pptx.ShapeType.roundRect, {
                        x: 5, y: 2, w: 3, h: 2,
                        fill: { color: '667eea' },
                        rectRadius: 0.3,
                        shadow: { type: 'outer', blur: 15, offset: 8, angle: 135, color: '667eea', opacity: 0.5 }
                    });
                    
                    break;
                    
                case 'images':
                    slide.addText('ç”»åƒå‡¦ç†æ©Ÿèƒ½ãƒ‡ãƒ¢', { x: 1, y: 0.5, w: 8, h: 1, fontSize: 24, bold: true });
                    
                    // Base64ã‚µãƒ³ãƒ—ãƒ«ç”»åƒï¼ˆå°ã•ãªé’ã„æ­£æ–¹å½¢ï¼‰
                    const sampleImageData = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNkYPhfDwAChwGA60e6kgAAAABJRU5ErkJggg==';
                    
                    // é€šå¸¸ã®ç”»åƒ
                    slide.addImage({
                        data: sampleImageData,
                        x: 1, y: 2, w: 2, h: 1.5
                    });
                    
                    // é€æ˜åº¦ä»˜ãç”»åƒ
                    slide.addImage({
                        data: sampleImageData,
                        x: 4, y: 2, w: 2, h: 1.5,
                        transparency: 50
                    });
                    
                    // å›è»¢ç”»åƒ
                    slide.addImage({
                        data: sampleImageData,
                        x: 7, y: 2, w: 2, h: 1.5,
                        rotate: 45
                    });
                    
                    break;
                    
                case 'charts':
                    slide.addText('é«˜åº¦ãªãƒãƒ£ãƒ¼ãƒˆæ©Ÿèƒ½ãƒ‡ãƒ¢', { x: 1, y: 0.5, w: 8, h: 1, fontSize: 24, bold: true });
                    
                    // 3Dãƒãƒ¼ãƒãƒ£ãƒ¼ãƒˆ
                    slide.addChart(pptx.ChartType.bar3D, [
                        {
                            name: '3Dãƒ‡ãƒ¼ã‚¿',
                            labels: ['ã‚«ãƒ†ã‚´ãƒªA', 'ã‚«ãƒ†ã‚´ãƒªB', 'ã‚«ãƒ†ã‚´ãƒªC'],
                            values: [30, 45, 25]
                        }
                    ], {
                        x: 1, y: 2, w: 4, h: 3,
                        title: '3Dãƒãƒ¼ãƒãƒ£ãƒ¼ãƒˆ',
                        chartColors: ['4285F4', '34A853', 'FBBC04'],
                        showValue: true
                    });
                    
                    // ãƒãƒ«ãƒã‚·ãƒªãƒ¼ã‚ºãƒ©ã‚¤ãƒ³ãƒãƒ£ãƒ¼ãƒˆ
                    slide.addChart(pptx.ChartType.line, [
                        {
                            name: 'ã‚·ãƒªãƒ¼ã‚º1',
                            labels: ['1æœˆ', '2æœˆ', '3æœˆ', '4æœˆ'],
                            values: [10, 15, 12, 18]
                        },
                        {
                            name: 'ã‚·ãƒªãƒ¼ã‚º2',
                            labels: ['1æœˆ', '2æœˆ', '3æœˆ', '4æœˆ'],
                            values: [8, 12, 16, 14]
                        }
                    ], {
                        x: 5.5, y: 2, w: 4, h: 3,
                        title: 'ãƒãƒ«ãƒã‚·ãƒªãƒ¼ã‚ºãƒãƒ£ãƒ¼ãƒˆ',
                        showLegend: true,
                        chartColors: ['EA4335', '34A853']
                    });
                    
                    break;
            }
            
            pptx.writeFile({ fileName: `advanced-${type}-demo.pptx` });
        }
    </script>
</body>
</html>